{"version":3,"sources":["auth-provider.ts","utils/http.ts","utils/index.ts","utils/use-async.ts","components/lib.tsx","context/auth-context.tsx","components/pin.tsx","utils/use-optimistic-options.ts","utils/project.ts","utils/url.ts","screens/project-list/util.ts","screens/project-list/list.tsx","utils/user.ts","components/id-select.tsx","components/user-select.tsx","screens/project-list/search-panel.tsx","screens/project-list/index.tsx","assets/software-logo.svg","utils/kanban.ts","utils/task.ts","utils/task-type.ts","screens/kanban/util.ts","assets/task.svg","assets/bug.svg","screens/kanban/create-task.tsx","components/mark.tsx","components/drag-and-drop.tsx","screens/kanban/kanban-column.tsx","components/task-type-select.tsx","screens/kanban/search-panel.tsx","screens/kanban/create-kanban.tsx","screens/kanban/task-modal.tsx","screens/kanban/index.tsx","screens/epic/util.ts","screens/epic/create-epic.tsx","utils/epic.ts","screens/epic/index.tsx","screens/project/index.tsx","screens/project-list/project-modal.tsx","components/project-popover.tsx","components/user-popover.tsx","authenticated-app.tsx","unauthenticated-app/login.tsx","unauthenticated-app/register.tsx","assets/logo.svg","assets/left.svg","assets/right.svg","unauthenticated-app/index.tsx","components/error-boundary.tsx","App.tsx","reportWebVitals.ts","context/index.tsx","index.tsx"],"names":["apiUrl","process","localStorageKey","handleUserResponse","user","window","localStorage","setItem","token","logout","a","removeItem","http","endpoint","data","headers","customConfig","config","method","Authorization","toUpperCase","qs","stringify","body","JSON","fetch","then","response","status","auth","location","reload","Promise","reject","message","json","ok","useHttp","useAuth","useCallback","useDebounce","value","delay","useState","debouncedValue","setDebouncedValue","useEffect","timeout","setTimeout","clearTimeout","useDocumentTitle","title","keepOnUnmount","oldTitle","useRef","document","current","resetRoute","href","origin","defaultInitialState","stat","error","defaultConfig","throwOnError","useSafeDispatch","dispatch","mountedRef","useMountedRef","useAsync","initialState","initialConfig","useReducer","state","action","safeDispatch","retry","setRetry","setData","setError","run","promise","runConfig","Error","catch","isIdle","isLoading","isError","isSuccess","Row","styled","div","props","between","undefined","marginBottom","gap","FullPage","FullPageLoading","size","FullPageErrorFallback","ErrorBox","Text","type","ButtonNoPadding","Button","ScreenContainer","bootstrapUser","getItem","AuthContext","React","createContext","displayName","AuthProvider","callback","children","setUser","queryClient","useQueryClient","Provider","login","form","register","clear","context","useContext","Pin","checked","onCheckedChange","restProps","count","onChange","num","useConfig","queryKey","onSuccess","invalidateQueries","onMutate","target","previousItems","getQueryData","setQueryData","old","onError","newItem","useDeleteConfig","filter","item","id","useEditConfig","map","useAddConfig","useReorderConfig","useProjects","param","client","useQuery","useEditProject","useMutation","params","useAddProject","useProject","enabled","Boolean","useUrlQueryParam","keys","useSearchParams","searchParams","setSearchParams","useSetUrlSearchParam","stateKeys","useMemo","obj","filteredEntries","Object","entries","key","includes","fromEntries","subset","o","object","result","forEach","cleanObject","useProjectsSearchParams","setParam","personId","Number","useProjectsQueryKey","useProjectModal","projectCreate","setProjectCreate","editingProjectId","setEditingProjectId","setUrlParams","editingProject","projectModalOpen","open","close","startEdit","List","users","mutate","pagination","columns","disabled","render","project","pin","sorter","b","name","localeCompare","to","String","dataIndex","find","created","dayjs","format","rowKey","More","deleteProject","useDeleteProject","overlay","Item","onClick","Modal","confirm","content","okText","onOk","confirmDeleteProject","useUsers","IdSelect","defaultOptionName","options","length","toNumber","Option","option","isNaN","UserSelect","SearchPanel","layout","css","placeholder","evt","ProjectListScreen","list","Container","dataSource","loading","whyDidYouRender","_defs","_g","_extends","assign","i","arguments","source","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgSoftwareLogo","_ref","svgRef","titleId","viewBox","xmlns","focusable","className","width","color","ref","x1","y1","x2","y2","stopColor","offset","stroke","strokeWidth","fillRule","d","fill","ForwardRef","useKanbans","useTasks","useTaskTypes","useProjectIdInUrl","useLocation","pathname","match","useProjectInUrl","useKanbanSearchParams","projectId","useKanbansQueryKey","useTasksSearchParams","debouncedName","typeId","processorId","tagId","useTasksQueryKey","useTasksModal","editingTaskId","setEditingTaskId","useTask","editingTask","CreateTask","kanbanId","setName","addTask","useAddTask","mutateAsync","inputMode","setInputMode","submit","toggle","mode","onBlur","autoFocus","onPressEnter","Mark","keyword","arr","split","str","index","style","Drop","provided","isValidElement","cloneElement","droppableProps","innerRef","DropChild","forwardRef","Drag","draggableProps","dragHandleProps","TaskTypeIcon","taskTypes","taskType","src","taskIcon","bugIcon","alt","TaskCard","task","cursor","KanbanColumn","kanban","allTasks","tasks","TasksContainer","direction","droppableId","minHeight","taskIndex","draggableId","useDeleteKanban","cancelText","TaskTypeSelect","CreateKanban","addKanban","useAddKanban","labelCol","span","wrapperCol","TaskModal","useForm","useEditTask","editTask","editLoading","deleteTask","useDeleteTask","getFieldsValue","setFieldsValue","forceRender","onCancel","resetFields","confirmLoading","visible","initialValues","label","rules","required","textAlign","fontSize","KanbanScreen","currentProject","kanbans","kanbanIsLoading","onDragEnd","useDragEnd","ColumnsContainer","display","reorderKanban","useReorderKanban","reorderTask","useReorderTask","destination","fromId","toId","referenceId","fromKanbanId","toKanbanId","fromTask","toTask","useEpicSearchParams","useEpicsQueryKey","CreateEpic","useAddEpic","addEpic","onFinish","values","onClose","destroyOnClose","htmlType","EpicScreen","epics","useEpics","deleteEpic","useDeleteEpic","epicCreateOpen","setEpicCreateOpen","overflow","itemLayout","renderItem","epic","Meta","confirmDeleteEpic","description","start","end","epicId","ProjectScreen","routeType","units","useRouteType","Aside","selectedKeys","Main","path","element","replace","aside","ProjectModal","mutateLoading","ProjectPopover","projects","refetch","pinnedProjects","ContentContainer","onVisibleChange","placement","UserPopover","AuthenticatedApp","PageHeader","Header","HeaderLeft","HeaderRight","User","e","preventDefault","main","LoginScreen","handleSubmit","LongButton","RegisterScreen","cpassword","password","UnauthenticatedApp","isRegister","setIsRegister","Background","ShadowCard","Title","h2","left","right","header","logo","Card","ErrorBoundary","fallbackRender","Component","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","AppProviders","QueryClient","loadServer","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.02abe4ff.chunk.js","sourcesContent":["// 在真实环境中，如果使用 firebase 这种第三方 auth 服务的话，本文件不需要开发者开发\r\n\r\nimport { User } from \"types/user\";\r\n\r\nconst apiUrl = process.env.REACT_APP_API_URL;\r\n\r\nconst localStorageKey = '__auth_provider_token__'\r\n\r\nexport const getToken = () => window.localStorage.getItem(localStorageKey)\r\n\r\nexport const handleUserResponse = ({user}: {user: User}) => {\r\n    window.localStorage.setItem(localStorageKey, user.token || '')\r\n    return user\r\n}\r\n\r\nexport const login = (data: {username: string, password: string}) => {\r\n    return fetch(`${apiUrl}/login`, {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(data),\r\n    }).then(async (response: Response) => {\r\n        if (response.ok) {\r\n            return handleUserResponse(await response.json())\r\n        } else {\r\n            return Promise.reject(await response.json())\r\n        }\r\n    })\r\n}\r\n\r\nexport const register = (data: {username: string, password: string}) => {\r\n    return fetch(`${apiUrl}/register`, {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(data),\r\n    }).then(async (response: Response) => {\r\n        if (response.ok) {\r\n            return handleUserResponse(await response.json())\r\n        } else {\r\n            return Promise.reject(await response.json())\r\n        }\r\n    })\r\n}\r\n\r\nexport const logout = async () => window.localStorage.removeItem(localStorageKey)","import qs from 'qs'\r\nimport * as auth from 'auth-provider'\r\nimport { useAuth } from 'context/auth-context';\r\nimport { useCallback } from 'react';\r\n\r\nconst apiUrl = process.env.REACT_APP_API_URL;\r\n\r\ninterface Config extends RequestInit {\r\n    token?: string,\r\n    data?: object\r\n}\r\n\r\nexport const http = async (endpoint: string, {data, token, headers, ...customConfig}: Config = {}) => {\r\n    const config = {\r\n        method: 'GET',\r\n        headers: {\r\n            Authorization: token ? `Bearer ${token}` : '',\r\n            'Content-Type': data ? 'application/json' : ''\r\n        },\r\n        ...customConfig\r\n    }\r\n\r\n    if (config.method.toUpperCase() === 'GET') {\r\n        endpoint += `?${qs.stringify(data)}`\r\n    }else {\r\n        config.body = JSON.stringify(data || {})\r\n    }\r\n    // axios 和 fetch 的表现不一样，axios 可以直接在返回状态不为 2xx 的时候抛出异常\r\n    // 当服务端返回 401 和 500 时，fetch api 并不会抛出异常\r\n    return window.fetch(`${apiUrl}/${endpoint}`, config).then(async response => {\r\n        if (response.status === 401) {\r\n            await auth.logout()\r\n            window.location.reload()\r\n            return Promise.reject({message: '请重新登录'})\r\n        }\r\n        const data = await response.json()\r\n        if (response.ok) {\r\n            return data\r\n        } else {\r\n            return Promise.reject(data)\r\n        }\r\n    })\r\n}\r\n\r\n// JS 中的 typeof 是在 runtime 时运行的\r\n// return typeof 1 === 'number'\r\n// TS 中的 typeof 是在静态环境运行的，把 typeof http 后面的 http 提取类型处理，作用就是传入函数类型，Parameters 能够读出函数类型的参数类型\r\n// return (...[endpoint, config]: Parameters<typeof http>) =>\r\n\r\nexport const useHttp = () => {\r\n    const {user} = useAuth()\r\n    // return ([endpoint, config]: [string, Config]) => http(endpoint, {...config, token: user?.token})\r\n    // Utility Types 的用法：用泛型给它传入一个其它类型，然后 utility type 对这个类型进行某种操作\r\n    // TODO 讲解 TS 操作符 Utility Types ... 解构 [] typeof 是 TS 中的静态类型，在代码运行时并不会参与\r\n    return useCallback((...[endpoint, config]: Parameters<typeof http>) => http(endpoint, {...config, token: user?.token}), [user?.token])\r\n}\r\n// 联合类型\r\n// let myFavoriteNumber: string | number\r\n// myFavoriteNumber = 'seven'\r\n// myFavoriteNumber = 7\r\n// 交叉类型\r\n// type FavoriteNumber = string & number\r\n\r\n// 类型别名在很多情况下可以和 interface 互换\r\n// interface Person {\r\n//     name: string\r\n// }\r\n// type Person = {name: string}\r\n// const xiaoMing: Person = {name: 'xiaoming'}\r\n\r\n// 类型别名，interface 在这种情况下没法替代 type\r\n// type FavoriteNumber = string | number\r\n// let roseFavoriteNumber: FavoriteNumber = '6'\r\n\r\n// interface 也没法实现 Utility type\r\n// type Person = {\r\n//     name: string,\r\n//     age: number\r\n// }\r\n// const xiaoMing: Partial<Person> = {name: 'xiaoMing'}\r\n// const shenMiRen: Omit<Person, 'name'> = {age: 12}\r\n// const shenMiRen: Omit<Person, 'name' | 'age'> = {} 从 Person 中把 name 和 age 都删掉，然后形成新的类型，操作键值对\r\n\r\n// Pick 在对象中挑选几个键值，然后组成新的类型\r\n// type PersonOnlyName = Pick<Person, 'name'>\r\n// Exclude 过滤 PersonKeys 中的 name，操作联合类型\r\n// type Age = Exclude<PersonKeys, 'name'>\r\n\r\n// Partial 的实现 keyof 操作符 把对象类型的 key值 都全部取出，形成联合类型\r\n// type PersonKeys = keyof Person\r\n// type Partial<T> = {\r\n// 定义的泛型 P 要遍历整个 联合类型，作为可选的\r\n//     [P in keyof T] ?: T[P]\r\n// }","import { useEffect, useRef, useState } from \"react\"\r\n\r\n// !! 对值进行求反，转化成 布尔值\r\nexport const isFalsy = (value: unknown) => value === 0 ? false : !value\r\n\r\nexport const isVoid = (value: unknown) => value === undefined || value === null || value === ''\r\n\r\n/*\r\nlet a: object\r\na = {name : 'jack'}\r\na = () => {}\r\na = new RegExp('')\r\n// const b = {...(() => {})} // 空对象\r\n\r\nlet b: {[key: string]: unknown}\r\nb = {name: 'Jack'}\r\nb = () => {}\r\n */\r\n\r\n// 在一个函数里，改变传入的对象本身是不好的\r\n// result 成了一个空对象，因为是 object 类型，指普通的对象，通过 {...object}解构为什么会得到一个空对象类型\r\nexport const cleanObject = (object: {[key: string]: unknown}) => {\r\n    // object.name = 123123 // 会被污染\r\n    // Object.assign({}, object)\r\n    const result = { ...object }\r\n    Object.keys(result).forEach(key => {\r\n        // 当 value 为 0，result 也会被 delete\r\n        // @ts-ignore\r\n        const value = result[key]\r\n        if (isVoid(value)) {\r\n            // @ts-ignore\r\n            delete result[key]\r\n        }\r\n    })\r\n    return result\r\n}\r\n\r\n// 在页面刚加载时执行一个函数\r\n// callback 没用了，但是依赖 [] 中没有，可能是一个错误\r\nexport const useMount = (callback: () => void) => {\r\n    useEffect(() => {\r\n        callback()\r\n    // TODO 依赖项里加上 callback 会造成无限循环，这个和 useCallback 以及 useMemo 有关系\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [])\r\n}\r\n\r\n// delay?: number 参数可有可无\r\n// 后面用泛型来规范类型\r\nexport const useDebounce = <V>(value: V, delay?: number) => {\r\n    const [debouncedValue, setDebouncedValue] = useState(value)\r\n\r\n    // 在什么时候执行，在 value、delay 变化时执行，一般 delay 不会变化\r\n    // 当 value 变化，多久后执行 delay\r\n    useEffect(() => {\r\n        // 每次在 value 变化以后，设置一个定时器\r\n        const timeout = setTimeout(() => setDebouncedValue(value), delay)\r\n        // 每次在上一个 useEffect 处理完以后再运行\r\n        return () => clearTimeout(timeout)\r\n    }, [value, delay])\r\n\r\n    return debouncedValue\r\n}\r\n\r\nexport const useArray = <T>(initialArray: T[]) => {\r\n    const [value, setValue] = useState(initialArray);\r\n    return {\r\n        value,\r\n        setValue,\r\n        add: (item: T) => setValue([...value, item]),\r\n        clear: () => setValue([]),\r\n        removeIndex: (index: number) => {\r\n            const copy = [...value];\r\n            copy.splice(index, 1);\r\n            setValue(copy);\r\n        }\r\n    }\r\n}\r\n\r\nexport const useDocumentTitle = (title: string, keepOnUnmount: boolean = true) => {\r\n    // useRef 持久化变量\r\n    // 页面加载时：旧 title\r\n    // 加载后：新 title\r\n    const oldTitle = useRef(document.title).current\r\n    // 闭包\r\n    // 页面加载时：oldTitle === 旧 title  'React App'\r\n    // 加载后：oldTitle === 新 title \r\n\r\n    useEffect(() => {\r\n        document.title = title\r\n    }, [title])\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            if (!keepOnUnmount) {\r\n                // 如果不指定依赖，读到的就是 旧 title\r\n                document.title = oldTitle\r\n            }\r\n        }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [keepOnUnmount, oldTitle])\r\n}\r\n\r\nexport const resetRoute = () => window.location.href = window.location.origin\r\n\r\nexport const subset = <O extends {[key in string]: unknown}, K extends keyof O>(\r\n    obj: O,\r\n    keys: K[]\r\n) => {\r\n    const filteredEntries = Object.entries(obj).filter(([key]) => keys.includes(key as K))\r\n\r\n    return Object.fromEntries(filteredEntries) as Pick<O, K>;\r\n}\r\n\r\n/**\r\n * 返回组件的挂载状态，如果还没挂载或者已经卸载，返回 false;反之，返回true\r\n */\r\nexport const useMountedRef = () => {\r\n    const mountedRef = useRef(false)\r\n\r\n    useEffect(() => {\r\n        // 加载\r\n        mountedRef.current = true\r\n        // 卸载\r\n        return () => {\r\n            mountedRef.current = false\r\n        }\r\n    })\r\n\r\n    return mountedRef\r\n}\r\n\r\n// 处理快速事件和监听鼠标事件、改变窗口事件、keyboard 键盘事件\r\n// const debounce = (func, delay) => {\r\n//     let timeout;\r\n//     return (...param) => {\r\n//         if (timeout) {\r\n//             clearTimeout(timeout);\r\n//         }\r\n//         timeout = setTimeout(function() {\r\n//             func(...param);\r\n//         }, delay);\r\n//     }\r\n// }\r\n\r\n// const log = debounce(() => console.log('call'), 5000)\r\n\r\n// log()\r\n// log()\r\n// log()\r\n\r\n// react hook 与 闭包，hook 与 闭包经典的坑\r\n/*\r\nconst test = () => {\r\n    let num = 0\r\n\r\n    const effect = () => {\r\n        num += 1\r\n        const message = `现在的num值：${num}`\r\n        return function unmount() {\r\n            console.log(message)\r\n        }\r\n    }\r\n\r\n    return effect\r\n}\r\n// 执行 test，返回 effect 函数\r\nconst add = test()\r\n// 执行 effect 函数，返回引用了 message1 的 unmount 函数\r\nconst unmount = add()\r\n// 再一次执行 effect 函数，返回引用了 message2 的 unmount 函数\r\nadd()\r\n// message3\r\nadd()\r\n// message4\r\nadd()\r\n// message5\r\nadd()\r\nunmount() // 在这里会打印什么呢？按照直觉似乎应该打印3，实际上打印了 1\r\n\r\nexport const Test = () => {\r\n    const [num, setNum] = useState(0)\r\n\r\n    const add = () => setNum(num + 1)\r\n\r\n    // 只有在页面加载时会执行一次，useEffect 形成了闭包，而 作用域 引用的就是页面加载时的num值，后面无论怎么渲染 num 怎么变化， useMount和useEffect都不会再执行 \r\n    // 回调函数闭包形成的作用域，引用永远就是页面初始加载值，怎么保证 num 值是新鲜的呢？\r\n    // [] 依赖没有指明 num，[num] 每当 num 变化时，useEffect 中的 return 都会重新定义一遍，这样就会拿到 num 最新值\r\n    // useEffect 中出现闭包问题，首先检查 [] 依赖项是否出现问题\r\n    useEffect(() => {\r\n        const id = setInterval(() => {\r\n            console.log(\"num in setInterval:\", num)\r\n        }, 1000)\r\n        return () => clearInterval(id)\r\n    }, [num])\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            console.log(\"卸载值：\", num)\r\n        }\r\n    }, [num])\r\n\r\n    return <div>\r\n        <button onClick={add}>add</button>\r\n        <p>\r\n\r\n    </div>\r\n}\r\n*/","import { useCallback, useReducer, useState } from \"react\"\r\nimport { useMountedRef } from \"utils\"\r\n\r\ninterface State<D> {\r\n    error: Error | null;\r\n    data: D | null;\r\n    stat: 'idle' | 'loading' | 'error' | 'success'\r\n}\r\n\r\n// defaultInitialState 自带的 State\r\nconst defaultInitialState: State<null> = {\r\n    stat: 'idle',\r\n    data: null,\r\n    error: null\r\n}\r\n\r\n// 可选抛出异常\r\nconst defaultConfig = {\r\n    throwOnError: false\r\n}\r\n\r\nconst useSafeDispatch = <T>(dispatch: (...args: T[]) => void) => {\r\n    const mountedRef = useMountedRef()\r\n\r\n    return useCallback((...args: T[]) => (mountedRef.current ? dispatch(...args) : void 0), [dispatch, mountedRef])\r\n}\r\n\r\n// TODO 用 reducer 改造\r\n// initialState 用户传入的 State，优先级比 defaultInitialState 高\r\nexport const useAsync = <D>(initialState?: State<D>, initialConfig?: typeof defaultConfig) => {\r\n    const config = {...defaultConfig, ...initialConfig}\r\n    \r\n    const [state, dispatch] = useReducer((state: State<D>, action: Partial<State<D>>) => ({...state, ...action}), {\r\n        ...defaultInitialState,\r\n        ...initialState\r\n    })\r\n\r\n    const safeDispatch = useSafeDispatch(dispatch);\r\n\r\n    // useRef 定义的值并不是本组件的状态，只是一个普通的变量\r\n    // useState 直接传入函数的含义是：惰性初始化，所以，要用 useState 保存函数，不能直接传入函数\r\n    // 怎么记住上一次run的状态\r\n    const [retry, setRetry] = useState(() => () => {\r\n\r\n    })\r\n\r\n    const setData = useCallback((data: D) => safeDispatch({\r\n        data,\r\n        stat: 'success',\r\n        error: null\r\n    }), [safeDispatch]);\r\n\r\n    const setError = useCallback((error: Error) => safeDispatch({\r\n        error,\r\n        data: null,\r\n        stat: 'error'\r\n    }), [safeDispatch]);\r\n\r\n    // run 用来触发异步请求， Promise 是一个容器\r\n    const run = useCallback((promise: Promise<D>, runConfig?: {retry: () => Promise<D>}) => {\r\n        if(!promise || !promise.then) {\r\n            throw new Error('请传入 Promise 类型数据')\r\n        }\r\n\r\n        setRetry(()=> () => {\r\n            if(runConfig?.retry) {\r\n                run(runConfig?.retry(), runConfig)\r\n            }\r\n        })\r\n        // 执行一个函数，函数参数是 prevState\r\n        safeDispatch({stat: 'loading'})\r\n        return promise.then((data) => {\r\n            setData(data)\r\n            return data\r\n        }).catch((error) => {\r\n            // catch 会消化异常，如果不主动抛出，外面是接收不到异常的\r\n            setError(error);\r\n            if (config.throwOnError) return Promise.reject(error);\r\n            return error;\r\n        })\r\n    }, [config.throwOnError, setData, setError, safeDispatch])\r\n\r\n    return {\r\n        isIdle: state.stat === 'idle',\r\n        isLoading: state.stat === 'loading',\r\n        isError: state.stat === 'error',\r\n        isSuccess: state.stat === 'success',\r\n        run,\r\n        setData,\r\n        setError,\r\n        // retry 被调用时重新跑一遍 run, 让 state 刷新一遍\r\n        retry,\r\n        ...state\r\n    }\r\n}","import React from \"react\";\r\nimport styled from '@emotion/styled';\r\nimport { Button, Spin, Typography } from 'antd';\r\nimport { DevTools } from \"jira-dev-tool\";\r\n\r\nexport const Row = styled.div<{\r\n    gap?: number | boolean,\r\n    between?: boolean,\r\n    marginBottom?: number\r\n}>`\r\ndisplay: flex;\r\nalign-items: center;\r\njustify-content: ${props => props.between ? 'space-between' : undefined};\r\nmargin-bottom: ${props => props.marginBottom + 'rem'};\r\n> * {\r\nmargin-top: 0 !important;\r\nmargin-bottom: 0 !important;\r\nmargin-right: ${props => typeof props.gap === 'number' ? props.gap + 'rem' : props.gap ? '2rem' : undefined};\r\n}\r\n`\r\n\r\nconst FullPage = styled.div`\r\nheight: 100vh;\r\ndisplay: flex;\r\njustify-content: center;\r\nalign-items: center;\r\n`\r\n\r\nexport const FullPageLoading = () => <FullPage>\r\n    <Spin size={'large'}></Spin>\r\n</FullPage>\r\n\r\nexport const FullPageErrorFallback = ({error}: {error: Error | null}) => <FullPage>\r\n    <DevTools />\r\n    <ErrorBox error={error}></ErrorBox>\r\n</FullPage>\r\n\r\n// 类型守卫 当符合 value?.message 条件时，value 就是 Error 类型\r\nconst isError = (value: any): value is Error => value?.message\r\n\r\nexport const ErrorBox = ({error}: {error: unknown}) => {\r\n    if(isError(error)) {\r\n        return <Typography.Text type={'danger'}>{error?.message}</Typography.Text>\r\n    }\r\n    return null\r\n}\r\n\r\nexport const ButtonNoPadding = styled(Button)`\r\npadding: 0;\r\n`\r\n\r\nexport const ScreenContainer = styled.div`\r\npadding: 3.2rem;\r\nwidth: 100%;\r\ndisplay: flex;\r\nflex-direction: column;\r\n`","import React, { ReactNode } from \"react\";\r\nimport * as auth from \"auth-provider\";\r\nimport { User } from \"types/user\";\r\nimport { http } from 'utils/http';\r\nimport { useMount } from \"utils\";\r\nimport { useAsync } from \"utils/use-async\";\r\nimport { FullPageErrorFallback, FullPageLoading } from \"components/lib\";\r\nimport { useQueryClient } from \"react-query\";\r\n\r\ninterface AuthForm {\r\n    username: string;\r\n    password: string;\r\n}\r\n\r\n// 初始化 user\r\nconst bootstrapUser = async () => {\r\n    let user = null\r\n    const token = auth.getToken()\r\n    if (token) {\r\n        // 单独指定 token 从 localStorage 获取 token\r\n        const data = await http('me', {token})\r\n        user = data.user\r\n    }\r\n    return user\r\n}\r\n\r\nconst AuthContext = React.createContext<{\r\n    user: User | null,\r\n    register: (form: AuthForm) => Promise<void>,\r\n    login: (form: AuthForm) => Promise<void>,\r\n    logout: () => Promise<void>,\r\n} | undefined>(undefined)\r\nAuthContext.displayName = 'AuthContext'\r\n\r\nexport const AuthProvider = ({children}: {children: ReactNode}) => {\r\n    // 页面刷新 user 默认为 null\r\n    // const [user, setUser] = useState<User | null>(null)\r\n    const {data: user, error, isLoading, isIdle, isError, run, setData: setUser} = useAsync<User | null>()\r\n\r\n    const queryClient = useQueryClient()\r\n\r\n    // point free 消参 setUser\r\n    const login = (form: AuthForm) => auth.login(form).then(setUser)\r\n    const register = (form: AuthForm) => auth.register(form).then(setUser)\r\n    const logout = () => auth.logout().then(() => {\r\n        setUser(null)\r\n        queryClient.clear()\r\n    })\r\n\r\n    // 页面加载时需要调用 bootstrapUser，第一步调用 getToken, 从 localStorage 尝试读取存储的 __auth_provider_token__\r\n    // 如果能读到值，就带着 token 去请求 me api，这个 me api 的返回值包括 user 信息，将 data 中的 user 赋值给 user，再返回出去\r\n    useMount(() => {\r\n        run(bootstrapUser())\r\n    })\r\n\r\n    if (isIdle || isLoading) {\r\n        return <FullPageLoading></FullPageLoading>\r\n    }\r\n\r\n    if(isError) {\r\n        return <FullPageErrorFallback error={error}></FullPageErrorFallback>\r\n    }\r\n\r\n    return <AuthContext.Provider children={children} value={{user, login, register, logout}} />\r\n}\r\n\r\n// 自定义 hook\r\nexport const useAuth = () => {\r\n    const context = React.useContext(AuthContext)\r\n    if (!context) {\r\n        throw new Error(\"useAuth 必须在 AuthProvider 中使用\")\r\n    }\r\n    return context\r\n}","import React from \"react\";\r\nimport { Rate } from \"antd\";\r\n\r\ninterface PinProps extends React.ComponentProps<typeof Rate> {\r\n    checked: boolean;\r\n    onCheckedChange?:(checked: boolean) => void\r\n}\r\n\r\nexport const Pin = ({checked, onCheckedChange, ...restProps}: PinProps) => {\r\n    return <Rate count={1} value={checked ? 1 : 0} onChange={num => onCheckedChange?.(!!num)} {...restProps}/>\r\n}","import { QueryKey, useQueryClient } from \"react-query\";\r\n\r\n// 乐观更新\r\nexport const useConfig = (queryKey: QueryKey, callback: (target: any, old?: any[]) => any[]) => {\r\n    const queryClient = useQueryClient()\r\n    return {\r\n        onSuccess: () => queryClient.invalidateQueries(queryKey),\r\n        // 乐观更新，在异步请求还没回来之前就把本地数据进行更新\r\n        async onMutate(target: any) {\r\n            const previousItems = queryClient.getQueryData(queryKey)\r\n            queryClient.setQueryData(queryKey, (old?: any[]) => {\r\n                return callback(target, old)\r\n            })\r\n            // 回滚机制\r\n            return {previousItems}\r\n        },\r\n        onError(error: any, newItem: any, context: any) {\r\n            queryClient.setQueryData(queryKey, context.previousItems)\r\n        }\r\n    }\r\n}\r\n\r\nexport const useDeleteConfig = (queryKey: QueryKey) => useConfig(queryKey, (target, old) => old?.filter(item => item.id !== target.id) || [])\r\nexport const useEditConfig = (queryKey: QueryKey) => useConfig(queryKey, (target, old) => old?.map(item => item.id === target.id ? {...item, ...target} : item) || [])\r\nexport const useAddConfig = (queryKey: QueryKey) => useConfig(queryKey, (target, old) => old ? [...old, target] : [])\r\n\r\nexport const useReorderConfig = (queryKey: QueryKey) => useConfig(queryKey, (target, old) => old || [])","import { useHttp } from \"utils/http\"\r\nimport { Project } from \"types/project\"\r\nimport { QueryKey, useMutation, useQuery } from \"react-query\"\r\nimport { useAddConfig, useDeleteConfig, useEditConfig } from \"./use-optimistic-options\"\r\n\r\nexport const useProjects = (param?: Partial<Project>) => {\r\n    const client = useHttp()\r\n    \r\n    // param 变化 useQuery 重新触发，获取数据/列表数据\r\n    return useQuery<Project[]>(['projects', param], () => client('projects', {data: param}))\r\n}\r\n\r\n// 编辑\r\nexport const useEditProject = (queryKey: QueryKey) => {\r\n    const client = useHttp()\r\n    return useMutation((params: Partial<Project>) => client(`projects/${params.id}`, {\r\n        method: 'PATCH',\r\n        data: params\r\n    }),\r\n    useEditConfig(queryKey)\r\n    )\r\n}\r\n\r\n// 添加\r\nexport const useAddProject = (queryKey: QueryKey) => {\r\n    const client = useHttp()\r\n\r\n    return useMutation((params: Partial<Project>) => client(`projects`, {\r\n            data: params,\r\n            method: 'POST'\r\n        }),\r\n        useAddConfig(queryKey)\r\n    )\r\n}\r\n\r\n// 删除\r\nexport const useDeleteProject = (queryKey: QueryKey) => {\r\n    const client = useHttp()\r\n\r\n    return useMutation(({id}: {id: number}) => client(`projects/${id}`, {\r\n            method: 'DELETE'\r\n        }),\r\n        useDeleteConfig(queryKey)\r\n    )\r\n}\r\n\r\n// 获取项目详情\r\nexport const useProject = (id?: number) => {\r\n    const client = useHttp()\r\n    return useQuery<Project>(\r\n        ['project', {id}],\r\n        () => client(`projects/${id}`),\r\n        {\r\n            enabled: Boolean(id)\r\n        }\r\n    )\r\n}","import { useMemo, useState } from 'react'\r\nimport { URLSearchParamsInit, useSearchParams } from 'react-router-dom'\r\nimport { cleanObject, subset } from 'utils'\r\n/**\r\n * 返回页面 url 中，指定键的参数值\r\n */\r\nexport const useUrlQueryParam = <K extends string>(keys: K[]) => {\r\n    const [searchParams] = useSearchParams()\r\n    const setSearchParams = useSetUrlSearchParam()\r\n    const [stateKeys] = useState(keys)\r\n    return [\r\n        // 每一次都会创建新的对象，当是基本类型的时候，就不会无限循环；当是对象的时候，就会无限循环；当是对象的 state 时，不会无限循环\r\n        useMemo(\r\n            () => subset(Object.fromEntries(searchParams), stateKeys) as {\r\n                [key in K]: string\r\n            },\r\n            // useMemo 当 searchParams 改变时才进行 keys.reduce 运算\r\n            // eslint-disable-next-line react-hooks/exhaustive-deps\r\n            [searchParams, stateKeys]\r\n        ),\r\n        // 改变 url 参数值\r\n        (params: Partial<{[key in K]: unknown}>) => {\r\n            // params 覆盖前面的 searchParams\r\n            // iterator 遍历器 Object.fromEntries 把键值对列表转换为一个对象\r\n            return setSearchParams(params)\r\n        }\r\n    // as const 返回最原始的类型\r\n    ] as const\r\n}\r\n\r\nexport const useSetUrlSearchParam = () => {\r\n    const [searchParams, setSearchParams] = useSearchParams()\r\n    return (params: {[key in string]: unknown}) => {\r\n        const o = cleanObject({...Object.fromEntries(searchParams), ...params}) as URLSearchParamsInit\r\n        return setSearchParams(o)\r\n    }\r\n}","import { useMemo } from \"react\"\r\nimport { useProject } from \"utils/project\"\r\nimport { useSetUrlSearchParam, useUrlQueryParam } from \"utils/url\"\r\n\r\n// 项目列表搜索的参数\r\nexport const useProjectsSearchParams = () => {\r\n    const [param, setParam] = useUrlQueryParam(['name', 'personId'])\r\n    return [\r\n        useMemo(() => ({...param, personId: Number(param.personId) || undefined}), [param]),\r\n        setParam\r\n    ] as const\r\n}\r\n\r\nexport const useProjectsQueryKey = () => {\r\n    const [params] = useProjectsSearchParams()\r\n    return ['projects', params]\r\n}\r\n\r\nexport const useProjectModal = () => {\r\n    const [{projectCreate}, setProjectCreate] = useUrlQueryParam(['projectCreate'])\r\n    const [{editingProjectId}, setEditingProjectId] = useUrlQueryParam(['editingProjectId'])\r\n\r\n    const setUrlParams = useSetUrlSearchParam()\r\n\r\n    const {data: editingProject, isLoading} = useProject(Number(editingProjectId))\r\n\r\n    const open = () => setProjectCreate({projectCreate: true})\r\n    const close = () => setUrlParams({projectCreate: \"\", editingProjectId: \"\"})\r\n    const startEdit = (id: number) => setEditingProjectId({editingProjectId: id})\r\n\r\n    return {\r\n        projectModalOpen: projectCreate === 'true' || Boolean(editingProjectId),\r\n        open,\r\n        close,\r\n        startEdit,\r\n        editingProject,\r\n        isLoading\r\n    }\r\n}","import React from \"react\"\r\nimport { User } from \"types/user\"\r\nimport { Dropdown, Table, TableProps, Menu, Modal } from 'antd'\r\nimport dayjs from \"dayjs\"\r\n// react-router 和 react-router-dom 的关系，类似于 react 和 react-dom/react-native/react-vr\r\nimport { Link } from \"react-router-dom\"\r\nimport { Pin } from \"components/pin\"\r\nimport { useDeleteProject, useEditProject } from \"utils/project\"\r\nimport { ButtonNoPadding } from \"components/lib\"\r\nimport { useProjectModal, useProjectsQueryKey } from \"./util\"\r\nimport { Project } from \"../../types/project\"\r\n// TableProps 是 Table 组件的属性类型, ListProps 类型由两部分组成，一个是 TableProps Table 上所有属性的集合的类型，还有一个是 users，两个组合在一起构成了 ListProps\r\ninterface ListProps extends TableProps<Project> {\r\n    users: User[];\r\n}\r\n\r\n// {users, ...props} 不管对象传入什么类型，第一件事是把 users 取出，剩下的键值放在 props\r\n// type PropsType = Omit<ListProps, 'users'>\r\nexport const List = ({users, ...props}: ListProps) => {\r\n    const {mutate} = useEditProject(useProjectsQueryKey())\r\n    // pointfree 函数式编程\r\n    const pinProject = (id: number) => (pin: boolean) => mutate({id, pin})\r\n\r\n    // localeCompare 对中文字符进行排序\r\n    return <Table pagination={false} columns={[\r\n        {\r\n            title: <Pin checked={true} disabled={true} />,\r\n            render(value, project) {\r\n                return <Pin checked={project.pin} onCheckedChange={pinProject(project.id)} />\r\n            }\r\n        },\r\n        {\r\n            title: '名称',\r\n            sorter: (a, b) => a.name.localeCompare(b.name),\r\n            render(value, project) {\r\n                return <Link to={String(project.id)}>{project.name}</Link>\r\n            }\r\n        },\r\n        {title: '部门', dataIndex: 'organization'},\r\n        {title: '负责人', render(value, project){\r\n            return <span>\r\n                {users.find((user: User) => user.id === project.personId)?.name || '未知'}\r\n            </span>\r\n        }},\r\n        {title: '创建时间', render(value, project){\r\n            return <span>\r\n                {project.created ? dayjs(project.created).format('YYYY-MM-DD') : '无'}\r\n            </span>\r\n        }},{\r\n            render(value, project){\r\n                return <More project={project}></More>\r\n            }\r\n        }\r\n        // rowKey={\"id\"}\r\n    ]} {...props} rowKey={columns => columns.id}/>\r\n}\r\n\r\nconst More = ({project}: {project: Project}) => {\r\n    const {startEdit} = useProjectModal()\r\n    const editProject = (id: number) => () => startEdit(id)\r\n    const {mutate: deleteProject} = useDeleteProject(useProjectsQueryKey())\r\n\r\n    const confirmDeleteProject = (id: number) => {\r\n        Modal.confirm({\r\n          title: '确定删除这个项目吗？',\r\n          content: '点击确定删除',\r\n          okText: '确定',\r\n          onOk() {\r\n            deleteProject({id})\r\n          }  \r\n        })\r\n    }\r\n\r\n    return <Dropdown overlay={<Menu>\r\n        <Menu.Item onClick={editProject(project.id)} key={'edit'}>\r\n            编辑\r\n        </Menu.Item>\r\n        <Menu.Item onClick={() => confirmDeleteProject(project.id)} key={'delete'}>\r\n            删除\r\n        </Menu.Item>\r\n    </Menu>}>\r\n        <ButtonNoPadding type={\"link\"}>...</ButtonNoPadding>\r\n    </Dropdown>\r\n}","import { useQuery } from \"react-query\";\r\nimport { User } from \"types/user\";\r\nimport { useHttp } from \"utils/http\";\r\n\r\nexport const useUsers = (param?: Partial<User>) => {\r\n    const client = useHttp();\r\n\r\n    return useQuery<User[]>([\"users\", param], () => client(\"users\", {data: param}))\r\n}","import React from 'react'\r\nimport { Select } from 'antd'\r\nimport { Raw } from 'types'\r\n\r\n// 直接从 Select 中读取属性\r\ntype SelectProps = React.ComponentProps<typeof Select>\r\n\r\ninterface IdSelectProps extends Omit<SelectProps, 'value' | 'onChange' | 'options'> {\r\n    value?: Raw | null | undefined,\r\n    onChange?: (value?: number) => void,\r\n    defaultOptionName?: string,\r\n    options?: {name: string, id: number}[]\r\n}\r\n\r\n/**\r\n * value 可以传入多种类型的值\r\n * onChange 只会回调 number | undefined 类型\r\n * 当 isNaN(Number(value)) 为 true 的时候，代表选择默认类型\r\n * 当选择默认类型的时候，onChange 会回调 undefined\r\n * @param props \r\n */\r\nexport const IdSelect = (props: IdSelectProps) => {\r\n    const {value, onChange, defaultOptionName, options, ...restProps} = props\r\n    return <Select value={options?.length ? toNumber(value) : 0} onChange={value => onChange?.(toNumber(value) || undefined)} {...restProps}>\r\n        {\r\n            defaultOptionName ? <Select.Option value={0}>{defaultOptionName}</Select.Option> : null\r\n        }\r\n        {\r\n            options?.map(option => <Select.Option key={option.id} value={option.id}>{option.name}</Select.Option>)\r\n        }\r\n    </Select>\r\n}\r\n\r\nconst toNumber = (value: unknown) => isNaN(Number(value)) ? 0 : Number(value)","import React from \"react\";\r\nimport { useUsers } from \"utils/user\";\r\nimport { IdSelect } from \"./id-select\";\r\n\r\nexport const UserSelect = (props: React.ComponentProps<typeof IdSelect>) => {\r\n    const {data: users} = useUsers()\r\n    return <IdSelect options={users || []} {...props}/>\r\n}","/** @jsxImportSource @emotion/react */\r\nimport React from \"react\"\r\nimport { Form, Input } from \"antd\"\r\nimport { Project } from \"../../types/project\"\r\nimport { UserSelect } from \"components/user-select\"\r\nimport { User } from \"../../types/user\"\r\n\r\ninterface SearchPanelProps {\r\n    users: User[];\r\n    param: Partial<Pick<Project, 'name' | 'personId'>>;\r\n    setParam: (param: SearchPanelProps['param']) => void; // void 什么也不返回，下次更改 param 那 SearchPanelProps 也会跟着更改\r\n}\r\n\r\n// param, setParam 解构赋值\r\n// 对函数的每一个形参都有规定类型\r\nexport const SearchPanel = ({users, param, setParam}: SearchPanelProps) => {\r\n\r\n    return (<Form layout={\"inline\"} css={{marginBottom: '2rem'}}>\r\n        <Form.Item>\r\n            {/* setParam(Object.assign({}, param, {name: evt.target.value})) 防止修改状态值 */}\r\n            <Input placeholder={'项目名'} type=\"text\" value={param.name} onChange={evt => setParam({\r\n                ...param, // 解构 param\r\n                name: evt.target.value\r\n            })}></Input>\r\n        </Form.Item>\r\n        <Form.Item>\r\n            <UserSelect\r\n                defaultOptionName={'负责人'}\r\n                value={param.personId}\r\n                onChange={\r\n                    (value) => setParam({\r\n                        ...param,\r\n                        personId: value\r\n                    })\r\n                } />\r\n        </Form.Item>\r\n    </Form>)\r\n}","import React from \"react\"\r\nimport { useDebounce, useDocumentTitle } from \"utils/index\"\r\n\r\nimport { List } from \"./list\"\r\nimport { SearchPanel } from \"./search-panel\"\r\nimport styled from \"@emotion/styled\"\r\nimport { useProjects } from \"utils/project\"\r\nimport { useUsers } from \"utils/user\"\r\nimport { useProjectModal, useProjectsSearchParams } from \"./util\"\r\nimport { ButtonNoPadding, ErrorBox, Row } from \"components/lib\"\r\n\r\n// const apiUrl = process.env.REACT_APP_API_URL\r\n\r\nexport const ProjectListScreen = () => {\r\n    useDocumentTitle('项目列表', false)\r\n\r\n    const {open} = useProjectModal()\r\n\r\n    // const [keys, setKeys] = useState<('name' | 'personId')[]>(['name', 'personId'])\r\n    // 基本类型，可以放到依赖里；组件状态，可以放到依赖里；非组件状态的对象，绝不可以放到依赖里\r\n    const [param, setParam] = useProjectsSearchParams()\r\n\r\n    // 对异步操作进行状态控制\r\n    // const [isLoading, setIsLoading] = useState(false)\r\n    // const [error, setError] = useState<null | Error>(null)\r\n\r\n    const { isLoading, error, data: list } = useProjects(useDebounce(param, 200))\r\n\r\n    const {data: users} = useUsers();\r\n\r\n    return (<Container>\r\n        <Row between={true}>\r\n            <h1>项目列表</h1>\r\n            <ButtonNoPadding onClick={open} type={\"link\"}>创建项目</ButtonNoPadding>\r\n        </Row>\r\n        <SearchPanel users={users || []} param={param} setParam={setParam}></SearchPanel>\r\n        <ErrorBox error={error} />\r\n        <List users={users || []} dataSource={list || []} loading={isLoading}></List>\r\n    </Container>);\r\n}\r\n\r\nProjectListScreen.whyDidYouRender = false\r\n\r\nconst Container = styled.div`\r\npadding: 3.2rem;\r\nflex: 1;\r\n`","var _defs, _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSoftwareLogo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 179 32\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    focusable: \"false\",\n    \"aria-hidden\": \"true\",\n    className: \"css-sq9aeg-Logo\",\n    width: \"18rem\",\n    color: \"rgb(38, 132, 255)\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"linearGradient\", {\n    x1: \"97.6553341%\",\n    y1: \"35.6591143%\",\n    x2: \"37.202032%\",\n    y2: \"75.4891864%\",\n    id: \"uid392-1\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#0052CC\",\n    offset: \"7%\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#2684FF\",\n    offset: \"100%\"\n  })), /*#__PURE__*/React.createElement(\"linearGradient\", {\n    x1: \"8.43371138%\",\n    y1: \"60.1495759%\",\n    x2: \"64.1161517%\",\n    y2: \"23.5790285%\",\n    id: \"uid392-2\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#0052CC\",\n    offset: \"0%\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#2684FF\",\n    offset: \"100%\"\n  })))), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    stroke: \"none\",\n    strokeWidth: 1,\n    fillRule: \"nonzero\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.3881081,27.9242105 C12.4881804,26.8071817 13.1062496,25.2917664 13.1062496,23.7115789 C13.1062496,22.1313915 12.4881804,20.6159762 11.3881081,19.4989474 L11.3881081,19.4989474 L3.74837838,11.7621053 L0.273513514,15.2926316 C-0.0900771727,15.6625064 -0.0900771727,16.2617042 0.273513514,16.6315789 L11.3881081,27.9242105 L11.3881081,27.9242105 Z\",\n    fill: \"currentColor\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M22.5027027,15.2926316 L11.3881081,4 L11.3881081,4 L11.3539189,4.03473684 L11.3539189,4.03473684 C9.08852466,6.36456187 9.09963243,10.1156459 11.3787838,12.4315789 L19.0247297,20.1652632 L22.5027027,16.6315789 C22.8662934,16.2617042 22.8662934,15.6625064 22.5027027,15.2926316 Z\",\n    fill: \"currentColor\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.3881081,12.4252632 C9.10895676,10.1093301 9.09784899,6.35824608 11.3632432,4.02842105 L3.43445946,12.0810526 L7.58067568,16.2936842 L11.3881081,12.4252632 Z\",\n    fill: \"url(#uid392-1)\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.1893243,15.6368421 L11.3881081,19.4989474 C12.4881804,20.6159762 13.1062496,22.1313915 13.1062496,23.7115789 C13.1062496,25.2917664 12.4881804,26.8071817 11.3881081,27.9242105 L19.3355405,19.8494737 L15.1893243,15.6368421 Z\",\n    fill: \"url(#uid392-2)\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M36.07,18.956 C36.07,20.646 35.394,21.842 33.418,21.842 C32.56,21.842 31.702,21.686 31,21.4 L31,23.662 C31.65,23.896 32.586,24.104 33.808,24.104 C37.032,24.104 38.41,21.946 38.41,18.8 L38.41,6.918 L36.07,6.918 L36.07,18.956 Z M41.894,7.568 C41.894,8.556 42.544,9.128 43.454,9.128 C44.364,9.128 45.014,8.556 45.014,7.568 C45.014,6.58 44.364,6.008 43.454,6.008 C42.544,6.008 41.894,6.58 41.894,7.568 Z M42.31,24 L44.546,24 L44.546,11 L42.31,11 L42.31,24 Z M47.926,24 L50.11,24 L50.11,16.33 C50.11,13.574 51.852,12.716 54.712,13.002 L54.712,10.818 C52.164,10.662 50.864,11.754 50.11,13.288 L50.11,11 L47.926,11 L47.926,24 Z M65.45,24 L65.45,21.66 C64.618,23.376 63.058,24.26 61.056,24.26 C57.598,24.26 55.856,21.322 55.856,17.5 C55.856,13.834 57.676,10.74 61.316,10.74 C63.214,10.74 64.67,11.598 65.45,13.288 L65.45,11 L67.686,11 L67.686,24 L65.45,24 Z M58.092,17.5 C58.092,20.62 59.34,22.18 61.654,22.18 C63.656,22.18 65.45,20.906 65.45,18.02 L65.45,16.98 C65.45,14.094 63.812,12.82 61.914,12.82 C59.392,12.82 58.092,14.484 58.092,17.5 Z M86.926,19.294 C86.926,16.226 84.898,15.056 81.284,14.146 C78.268,13.392 77.176,12.69 77.176,11.286 C77.176,9.726 78.502,8.946 80.738,8.946 C82.506,8.946 84.352,9.258 86.068,10.246 L86.068,7.906 C84.898,7.256 83.312,6.658 80.842,6.658 C76.864,6.658 74.836,8.634 74.836,11.286 C74.836,14.094 76.552,15.42 80.4,16.356 C83.65,17.136 84.586,17.942 84.586,19.45 C84.586,20.958 83.624,21.972 81.05,21.972 C78.788,21.972 76.344,21.374 74.758,20.542 L74.758,22.934 C76.084,23.61 77.618,24.26 80.92,24.26 C85.158,24.26 86.926,22.258 86.926,19.294 Z M95.09,24.26 C91.19,24.26 88.902,21.374 88.902,17.474 C88.902,13.574 91.19,10.74 95.09,10.74 C98.964,10.74 101.226,13.574 101.226,17.474 C101.226,21.374 98.964,24.26 95.09,24.26 Z M95.09,12.82 C92.308,12.82 91.086,15.004 91.086,17.474 C91.086,19.944 92.308,22.18 95.09,22.18 C97.846,22.18 99.042,19.944 99.042,17.474 C99.042,15.004 97.846,12.82 95.09,12.82 Z M106.92,9.622 C106.92,8.452 107.596,7.646 108.974,7.646 C109.494,7.646 109.988,7.698 110.378,7.776 L110.378,5.722 C109.988,5.618 109.546,5.514 108.87,5.514 C106.088,5.514 104.736,7.152 104.736,9.57 L104.736,11 L102.63,11 L102.63,13.08 L104.736,13.08 L104.736,24 L106.92,24 L106.92,13.08 L110.274,13.08 L110.274,11 L106.92,11 L106.92,9.622 Z M115.786,19.892 L115.786,13.08 L119.244,13.08 L119.244,11 L115.786,11 L115.786,8.244 L113.602,8.244 L113.602,11 L111.496,11 L111.496,13.08 L113.602,13.08 L113.602,19.944 C113.602,22.362 114.954,24 117.736,24 C118.412,24 118.854,23.896 119.244,23.792 L119.244,21.634 C118.854,21.712 118.36,21.816 117.84,21.816 C116.462,21.816 115.786,21.036 115.786,19.892 Z M125.432,24 L128.292,24 L130.528,17.708 L131.724,13.704 L132.92,17.708 L135.156,24 L138.016,24 L142.8,11 L140.33,11 L136.586,22.024 L132.79,11 L130.658,11 L126.862,22.024 L123.118,11 L120.648,11 L125.432,24 Z M153.538,24 L153.538,21.66 C152.706,23.376 151.146,24.26 149.144,24.26 C145.686,24.26 143.944,21.322 143.944,17.5 C143.944,13.834 145.764,10.74 149.404,10.74 C151.302,10.74 152.758,11.598 153.538,13.288 L153.538,11 L155.774,11 L155.774,24 L153.538,24 Z M146.18,17.5 C146.18,20.62 147.428,22.18 149.742,22.18 C151.744,22.18 153.538,20.906 153.538,18.02 L153.538,16.98 C153.538,14.094 151.9,12.82 150.002,12.82 C147.48,12.82 146.18,14.484 146.18,17.5 Z M159.154,24 L161.338,24 L161.338,16.33 C161.338,13.574 163.08,12.716 165.94,13.002 L165.94,10.818 C163.392,10.662 162.092,11.754 161.338,13.288 L161.338,11 L159.154,11 L159.154,24 Z M178.108,23.48 C177.042,24.052 175.404,24.26 174.078,24.26 C169.216,24.26 167.084,21.452 167.084,17.474 C167.084,13.548 169.268,10.74 173.22,10.74 C177.224,10.74 178.836,13.522 178.836,17.474 L178.836,18.488 L169.346,18.488 C169.658,20.698 171.088,22.128 174.156,22.128 C175.664,22.128 176.938,21.842 178.108,21.426 L178.108,23.48 Z M173.116,12.768 C170.75,12.768 169.554,14.302 169.32,16.564 L176.574,16.564 C176.444,14.146 175.352,12.768 173.116,12.768 Z\",\n    fill: \"inherit\",\n    fillRule: \"evenodd\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSoftwareLogo);\nexport default __webpack_public_path__ + \"static/media/software-logo.3562c1d3.svg\";\nexport { ForwardRef as ReactComponent };","import { QueryKey, useMutation, useQuery } from 'react-query'\r\nimport { Kanban } from 'types/kanban'\r\nimport { useHttp } from 'utils/http'\r\nimport { useAddConfig, useDeleteConfig, useReorderConfig } from './use-optimistic-options';\r\n\r\n\r\nexport const useKanbans = (param?: Partial<Kanban>) => {\r\n    const client = useHttp();\r\n\r\n    return useQuery<Kanban[]>([\"kanbans\", param], () => client(\"kanbans\", {data: param}))\r\n}\r\n\r\nexport const useAddKanban = (queryKey: QueryKey) => {\r\n    const client = useHttp()\r\n\r\n    return useMutation((params: Partial<Kanban>) => client(`kanbans`, {\r\n            data: params,\r\n            method: 'POST'\r\n        }),\r\n        useAddConfig(queryKey)\r\n    )\r\n}\r\n\r\nexport const useDeleteKanban = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        ({id}: {id: number}) => client(`kanbans/${id}`, {\r\n            method: \"DELETE\"\r\n        }),\r\n        useDeleteConfig(queryKey)\r\n    )\r\n}\r\n\r\nexport interface SortProps {\r\n    // 要重新排序的 item\r\n    fromId: number;\r\n    // 目标 item\r\n    referenceId: number;\r\n    // 放在目标 item 的前还是后\r\n    type: \"before\" | \"after\";\r\n    fromKanbanId?: number;\r\n    toKanbanId?: number;\r\n}\r\n\r\nexport const useReorderKanban = (queryKey: QueryKey) => {\r\n    const client = useHttp()\r\n    return useMutation(\r\n        (params: SortProps) => {\r\n            return client('kanbans/reorder', {\r\n                data: params,\r\n                method: \"POST\"\r\n            })\r\n        },\r\n        useReorderConfig(queryKey)\r\n    )\r\n}","import { QueryKey, useMutation, useQuery } from 'react-query'\r\nimport { Task } from 'types/task'\r\nimport { useHttp } from 'utils/http'\r\nimport { SortProps } from './kanban';\r\nimport { useAddConfig, useDeleteConfig, useEditConfig, useReorderConfig } from './use-optimistic-options';\r\n\r\n\r\nexport const useTasks = (param?: Partial<Task>) => {\r\n    const client = useHttp();\r\n\r\n    return useQuery<Task[]>([\"tasks\", param], () => client(\"tasks\", {data: param}))\r\n}\r\n\r\nexport const useAddTask = (queryKey: QueryKey) => {\r\n    const client = useHttp()\r\n\r\n    return useMutation((params: Partial<Task>) => client(`tasks`, {\r\n            data: params,\r\n            method: 'POST'\r\n        }),\r\n        useAddConfig(queryKey)\r\n    )\r\n}\r\n\r\nexport const useTask = (id?: number) => {\r\n    const client = useHttp()\r\n    return useQuery<Task>([\"task\", {id}], () => client(`tasks/${id}`), {\r\n        enabled: Boolean(id)\r\n    })\r\n}\r\n\r\nexport const useEditTask = (queryKey: QueryKey) => {\r\n    const client = useHttp()\r\n    return useMutation((params: Partial<Task>) => client(`tasks/${params.id}`, {\r\n        method: \"PATCH\",\r\n        data: params\r\n    }),\r\n    useEditConfig(queryKey)\r\n    )\r\n}\r\n\r\nexport const useDeleteTask = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        ({id}: {id: number}) => client(`tasks/${id}`, {\r\n            method: \"DELETE\"\r\n        }),\r\n        useDeleteConfig(queryKey)\r\n    )\r\n}\r\n\r\nexport const useReorderTask = (queryKey: QueryKey) => {\r\n    const client = useHttp()\r\n    return useMutation(\r\n        (params: SortProps) => {\r\n            return client('tasks/reorder', {\r\n                data: params,\r\n                method: \"POST\"\r\n            })\r\n        },\r\n        useReorderConfig(queryKey)\r\n    )\r\n}","import { useQuery } from 'react-query'\r\nimport { TaskType } from 'types/task-type';\r\nimport { useHttp } from 'utils/http'\r\n\r\n\r\nexport const useTaskTypes = () => {\r\n    const client = useHttp();\r\n\r\n    return useQuery<TaskType[]>([\"taskTypes\"], () => client(\"taskTypes\"))\r\n}","import { useCallback, useMemo } from \"react\"\r\nimport { useLocation } from \"react-router\"\r\nimport { useDebounce } from \"utils\"\r\nimport { useProject } from \"utils/project\"\r\nimport { useTask } from \"utils/task\"\r\nimport { useUrlQueryParam } from \"utils/url\"\r\n\r\nexport const useProjectIdInUrl = () => {\r\n    const {pathname} = useLocation()\r\n    const id = pathname.match(/projects\\/(\\d+)/)?.[1]\r\n    return Number(id)\r\n}\r\n\r\nexport const useProjectInUrl = () => useProject(useProjectIdInUrl())\r\n\r\nexport const useKanbanSearchParams = () => ({projectId: useProjectIdInUrl()})\r\n\r\nexport const useKanbansQueryKey = () => [\"kanbans\", useKanbanSearchParams()]\r\n\r\nexport const useTasksSearchParams = () => {\r\n    const [param] = useUrlQueryParam([\r\n        'name',\r\n        'typeId',\r\n        'processorId',\r\n        'tagId'\r\n    ])\r\n    const projectId =  useProjectIdInUrl()\r\n    const debouncedName = useDebounce(param.name, 2000)\r\n    return useMemo(() => ({\r\n        projectId,\r\n        typeId: Number(param.typeId) || undefined,\r\n        processorId: Number(param.processorId) || undefined,\r\n        tagId: Number(param.tagId) || undefined,\r\n        name: debouncedName\r\n    }), [projectId, param, debouncedName])\r\n}\r\n\r\nexport const useTasksQueryKey = () => [\"tasks\", useTasksSearchParams()]\r\n\r\nexport const useTasksModal = () => {\r\n    const [{editingTaskId}, setEditingTaskId] = useUrlQueryParam(['editingTaskId'])\r\n    const {data: editingTask, isLoading} = useTask(Number(editingTaskId))\r\n\r\n    const startEdit = useCallback((id: number) => {\r\n        setEditingTaskId({editingTaskId: id})\r\n    }, [setEditingTaskId])\r\n    const close = useCallback(() => {\r\n        setEditingTaskId({editingTaskId: ''})\r\n    }, [setEditingTaskId])\r\n\r\n    return {\r\n        editingTaskId,\r\n        editingTask,\r\n        startEdit,\r\n        close,\r\n        isLoading\r\n    }\r\n}","export default __webpack_public_path__ + \"static/media/task.69774797.svg\";","export default __webpack_public_path__ + \"static/media/bug.5d8e8fd5.svg\";","import React, { useEffect, useState } from \"react\";\r\nimport { Card, Input } from \"antd\";\r\nimport { useAddTask } from \"utils/task\";\r\nimport { useProjectIdInUrl, useTasksQueryKey } from \"./util\";\r\n\r\nexport const CreateTask = ({kanbanId}: {kanbanId: number}) => {\r\n    const [name, setName] = useState('')\r\n    const {mutateAsync: addTask} = useAddTask(useTasksQueryKey())\r\n    const projectId = useProjectIdInUrl()\r\n    const [inputMode, setInputMode] = useState(false)\r\n\r\n    const submit = async () => {\r\n        await addTask({projectId, name, kanbanId})\r\n        setInputMode(false)\r\n        setName('')\r\n    }\r\n\r\n    const toggle = () => setInputMode(mode => !mode)\r\n\r\n    useEffect(() => {\r\n        if(!inputMode) {\r\n            setName('')\r\n        }\r\n    }, [inputMode])\r\n\r\n    if (!inputMode) {\r\n        return <div onClick={toggle}>+创建事务</div>\r\n    }\r\n\r\n    return <Card>\r\n        <Input onBlur={toggle} placeholder={\"需要做些什么\"} autoFocus={true} onPressEnter={submit} value={name} onChange={evt => setName(evt.target.value)}></Input>\r\n    </Card>\r\n}","import React from \"react\";\r\n\r\nexport const Mark = ({name, keyword}: {name: string, keyword: string}) => {\r\n    if (!keyword) {\r\n        return <>{name}</>\r\n    }\r\n    const arr = name.split(keyword)\r\n    return <>\r\n        {\r\n            arr.map((str, index) => <span key={index}>\r\n                {str}\r\n                {\r\n                    index === arr.length - 1 ? null : <span style={{color: \"#257AFD\"}}>{keyword}</span>\r\n                }\r\n            </span>)\r\n        }\r\n    </>\r\n}","import React, { ReactNode } from \"react\";\r\nimport { Draggable, DraggableProps, Droppable, DroppableProps, DroppableProvided, DroppableProvidedProps } from \"react-beautiful-dnd\";\r\n\r\ntype DropProps = Omit<DroppableProps, \"children\"> & {children: ReactNode}\r\n\r\nexport const Drop = ({children, ...props}: DropProps) => {\r\n    return <Droppable {...props}>\r\n        {\r\n            (provided => {\r\n                if (React.isValidElement(children)) {\r\n                    return React.cloneElement(children, {\r\n                        ...provided.droppableProps,\r\n                        ref: provided.innerRef,\r\n                        provided\r\n                    })\r\n                }\r\n                return <div/>\r\n            })\r\n        }\r\n    </Droppable>\r\n}\r\n\r\n// 转发\r\ntype DropChildProps = Partial<{provided: DroppableProvided} & DroppableProvidedProps> & React.HTMLAttributes<HTMLDivElement>\r\nexport const DropChild = React.forwardRef<HTMLDivElement, DropChildProps>(({children, ...props}, ref) => <div ref={ref} {...props}>\r\n    {children}\r\n    {props.provided?.placeholder}\r\n</div>)\r\n\r\ntype DragProps = Omit<DraggableProps, \"children\"> & {children: ReactNode}\r\nexport const Drag = ({children, ...props}: DragProps) => {\r\n    return <Draggable {...props}>\r\n        {\r\n            provided => {\r\n                if (React.isValidElement(children)) {\r\n                    return React.cloneElement(children, {\r\n                        ...provided.draggableProps,\r\n                        ...provided.dragHandleProps,\r\n                        ref: provided.innerRef\r\n                    })\r\n                }\r\n                return <div/>\r\n            }\r\n        }\r\n    </Draggable>\r\n}","import React from 'react'\r\nimport { Kanban } from 'types/kanban'\r\nimport { useTasks } from 'utils/task'\r\nimport { useTaskTypes } from 'utils/task-type'\r\nimport { useKanbansQueryKey, useTasksModal, useTasksSearchParams } from './util'\r\nimport taskIcon from 'assets/task.svg'\r\nimport bugIcon from 'assets/bug.svg'\r\nimport styled from '@emotion/styled'\r\nimport { Button, Card, Dropdown, Menu, Modal } from 'antd'\r\nimport { CreateTask } from './create-task'\r\nimport { Task } from 'types/task'\r\nimport { Mark } from 'components/mark'\r\nimport { useDeleteKanban } from 'utils/kanban'\r\nimport { Row } from 'components/lib'\r\nimport { Drag, Drop, DropChild } from 'components/drag-and-drop'\r\n\r\nconst TaskTypeIcon = ({id}: {id: number}) => {\r\n    const {data: taskTypes} = useTaskTypes()\r\n    const name = taskTypes?.find(taskType => taskType.id === id)?.name\r\n    if (!name){\r\n        return null\r\n    }\r\n    return <img src={name === 'task' ? taskIcon : bugIcon} alt={\"task-icon\"}/>\r\n}\r\n\r\nconst TaskCard = ({task}: {task: Task}) => {\r\n    const {startEdit} = useTasksModal()\r\n    const {name: keyword} = useTasksSearchParams()\r\n    return <Card onClick={() => startEdit(task.id)} style={{marginBottom: '0.5rem', cursor: \"pointer\"}}>\r\n        <p>\r\n            <Mark keyword={keyword} name={task.name}></Mark>\r\n        </p>\r\n        <TaskTypeIcon id={task.typeId}></TaskTypeIcon>\r\n    </Card>\r\n}\r\n\r\nexport const KanbanColumn = React.forwardRef<HTMLDivElement, {kanban: Kanban}>(({kanban, ...props}, ref) => {\r\n    const {data: allTasks} = useTasks(useTasksSearchParams())\r\n    const tasks = allTasks?.filter(task => task.kanbanId === kanban.id)\r\n    \r\n    return <Container ref={ref} {...props}>\r\n        <Row between={true}>\r\n            <h3>{kanban.name}</h3>\r\n            <More kanban={kanban} key={kanban.id}></More>\r\n        </Row>\r\n        <TasksContainer>\r\n            <Drop type={\"ROW\"} direction={\"vertical\"} droppableId={String(kanban.id)}>\r\n                <DropChild style={{minHeight: '5px'}}>\r\n                    {\r\n                        tasks?.map((task, taskIndex) => <Drag key={task.id} index={taskIndex} draggableId={\"task\" + task.id}>\r\n                            <div>\r\n                                <TaskCard task={task}></TaskCard>\r\n                            </div>\r\n                        </Drag>)\r\n                    }\r\n                </DropChild>\r\n            </Drop>\r\n            <CreateTask kanbanId={kanban.id}></CreateTask>\r\n        </TasksContainer>\r\n    </Container>\r\n})\r\n\r\nconst More = ({kanban}: {kanban: Kanban}) => {\r\n    const {mutateAsync} = useDeleteKanban(useKanbansQueryKey())\r\n    const startEdit = () => {\r\n        Modal.confirm({\r\n            okText: \"确定\",\r\n            cancelText: \"取消\",\r\n            title: \"确定删除看板吗\",\r\n            onOk() {\r\n                return mutateAsync({id: kanban.id})\r\n            }\r\n        })\r\n    }\r\n    const overlay = <Menu>\r\n        <Menu.Item key={\"del\"}>\r\n            <Button type={\"link\"} onClick={startEdit}>\r\n                删除\r\n            </Button>\r\n        </Menu.Item>\r\n    </Menu>\r\n\r\n    return <Dropdown overlay={overlay}>\r\n        <Button type={'link'}>...</Button>\r\n    </Dropdown>\r\n}\r\n\r\nexport const Container = styled.div`\r\nmin-width: 27rem;\r\nborder-radius: 6px;\r\nbackground-color: rgb(244, 245, 247);\r\ndisplay: flex;\r\nflex-direction: column;\r\npadding: 0.7rem 0.7rem 1rem;\r\nmargin-right: 1.5rem;\r\n`\r\n\r\nconst TasksContainer = styled.div`\r\noverflow: scroll;\r\nflex: 1;\r\n\r\n::-webkit-scrollbar {\r\n    display: none;\r\n}\r\n`","import React from \"react\";\r\nimport { useTaskTypes } from \"utils/task-type\";\r\nimport { IdSelect } from \"./id-select\";\r\n\r\nexport const TaskTypeSelect = (props: React.ComponentProps<typeof IdSelect>) => {\r\n    const {data: taskTypes} = useTaskTypes()\r\n    return <IdSelect options={taskTypes || []} {...props}/>\r\n}","import React from 'react'\r\nimport { Row } from 'components/lib'\r\nimport {useTasksSearchParams} from 'screens/kanban/util'\r\nimport { useSetUrlSearchParam } from 'utils/url'\r\nimport { Button, Input } from 'antd'\r\nimport { UserSelect } from 'components/user-select'\r\nimport { TaskTypeSelect } from 'components/task-type-select'\r\n\r\nexport const SearchPanel = () => {\r\n    const searchParams = useTasksSearchParams()\r\n    const setSearchParams = useSetUrlSearchParam()\r\n    const reset = () => {\r\n        setSearchParams({\r\n            typeId: undefined,\r\n            processorId: undefined,\r\n            tagId: undefined,\r\n            name: undefined\r\n        })\r\n    }\r\n\r\n    return <Row marginBottom={4} gap={true}>\r\n        <Input style={{width: '20rem'}} placeholder={'任务名'} value={searchParams.name} onChange={evt => setSearchParams({name: evt.target.value})}></Input>\r\n        <UserSelect defaultOptionName={\"经办人\"} value={searchParams.processorId} onChange={value => setSearchParams({processorId: value})}></UserSelect>\r\n        <TaskTypeSelect defaultOptionName={\"类型\"} value={searchParams.typeId} onChange={value => setSearchParams({typeId: value})}></TaskTypeSelect>\r\n        <Button onClick={reset}>清除筛选器</Button>\r\n    </Row>\r\n}","import React from \"react\"\r\nimport { useState } from \"react\"\r\nimport { useAddKanban } from \"utils/kanban\"\r\nimport { useKanbansQueryKey, useProjectIdInUrl } from \"./util\"\r\nimport { Input } from \"antd\"\r\nimport { Container } from \"./kanban-column\"\r\n\r\n\r\nexport const CreateKanban = () => {\r\n    const [name, setName] = useState('')\r\n    const projectId = useProjectIdInUrl()\r\n    const {mutateAsync: addKanban} = useAddKanban(useKanbansQueryKey())\r\n\r\n    const submit = async () => {\r\n        await addKanban({name, projectId})\r\n        setName('')\r\n    }\r\n\r\n    return <Container>\r\n        <Input size={\"large\"} placeholder={\"新建看板名称\"} onPressEnter={submit} value={name} onChange={evt => setName(evt.target.value)}></Input>\r\n    </Container>\r\n}","import React, { useEffect } from \"react\";\r\nimport { useForm } from \"antd/es/form/Form\";\r\nimport { useTasksModal, useTasksQueryKey } from \"./util\";\r\nimport { useDeleteTask, useEditTask } from \"utils/task\";\r\nimport { Button, Form, Input, Modal } from \"antd\";\r\nimport { UserSelect } from \"components/user-select\";\r\nimport { TaskTypeSelect } from \"components/task-type-select\";\r\n\r\nconst layout = {\r\n    labelCol: {span: 8},\r\n    wrapperCol: {span: 16}\r\n}\r\n\r\nexport const TaskModal = () => {\r\n    const [form] = useForm()\r\n    const {editingTaskId, editingTask, close} = useTasksModal()\r\n    const {mutateAsync: editTask, isLoading: editLoading} = useEditTask(useTasksQueryKey())\r\n    const {mutate: deleteTask} = useDeleteTask(useTasksQueryKey())\r\n\r\n    const onCancel = () => {\r\n        close()\r\n        form.resetFields()\r\n    }\r\n\r\n    const onOk = async () => {\r\n        await editTask({...editingTask, ...form.getFieldsValue()})\r\n        close()\r\n    }\r\n\r\n    const startDelete = () => {\r\n        close()\r\n        Modal.confirm({\r\n            okText: \"确定\",\r\n            cancelText: \"取消\",\r\n            title: \"确定删除任务吗\",\r\n            onOk() {\r\n                return deleteTask({id: Number(editingTaskId)})\r\n            }\r\n        })\r\n    }\r\n\r\n    useEffect(() => {\r\n        form.setFieldsValue(editingTask)\r\n    }, [form, editingTask])\r\n\r\n    return <Modal forceRender={true} onCancel={onCancel} onOk={onOk} okText={\"确认\"} cancelText={\"取消\"} confirmLoading={editLoading} title={\"编辑任务\"} visible={!!editingTaskId}>\r\n        <Form {...layout} initialValues={editingTask} form={form} >\r\n            <Form.Item label={\"任务名\"} name={\"name\"} rules={[{required: true, message: \"请输入任务名\"}]}>\r\n                <Input></Input>\r\n            </Form.Item>\r\n            <Form.Item label={\"经办人\"} name={\"processorId\"}>\r\n                <UserSelect defaultOptionName={\"经办人\"}/>\r\n            </Form.Item>\r\n            <Form.Item label={\"类型\"} name={\"typeId\"}>\r\n                <TaskTypeSelect defaultOptionName={\"类型\"} />\r\n            </Form.Item>\r\n        </Form>\r\n        <div style={{textAlign: \"right\"}}>\r\n            <Button onClick={startDelete} size={\"small\"} style={{fontSize: \"14px\"}}>删除</Button>\r\n        </div>\r\n    </Modal>\r\n}","import React, { useCallback } from 'react'\r\nimport styled from '@emotion/styled'\r\nimport { useDocumentTitle } from 'utils'\r\nimport { useKanbans, useReorderKanban } from 'utils/kanban'\r\nimport { KanbanColumn } from './kanban-column'\r\nimport { SearchPanel } from './search-panel'\r\nimport { useKanbanSearchParams, useKanbansQueryKey, useProjectInUrl, useTasksQueryKey, useTasksSearchParams } from './util'\r\nimport { ScreenContainer } from 'components/lib'\r\nimport { useReorderTask, useTasks } from 'utils/task'\r\nimport { Spin } from 'antd'\r\nimport { CreateKanban } from './create-kanban'\r\nimport { TaskModal } from './task-modal'\r\nimport { DragDropContext, DropResult } from 'react-beautiful-dnd'\r\nimport { Drag, Drop, DropChild } from 'components/drag-and-drop'\r\n\r\nexport const KanbanScreen = () => {\r\n    useDocumentTitle('看板列表')\r\n    const {data: currentProject} = useProjectInUrl()\r\n    const {data: kanbans, isLoading: kanbanIsLoading} = useKanbans(useKanbanSearchParams())\r\n    const {isLoading: taskIsLoading} = useTasks(useTasksSearchParams())\r\n    const isLoading = taskIsLoading || kanbanIsLoading\r\n\r\n    const onDragEnd = useDragEnd()\r\n\r\n    return (\r\n        <DragDropContext onDragEnd={onDragEnd}>\r\n            <ScreenContainer>\r\n                <h1>{currentProject?.name}看板</h1>\r\n                <SearchPanel></SearchPanel>\r\n                {\r\n                    isLoading ? <Spin size={\"large\"}/> : (\r\n                        <ColumnsContainer>\r\n                            <Drop type={\"COLUMN\"} direction={\"horizontal\"} droppableId={\"kanban\"}>\r\n                                <DropChild style={{display: 'flex'}}>\r\n                                    {\r\n                                        kanbans?.map((kanban, index) => (\r\n                                            <Drag key={kanban.id} draggableId={\"kanban\" + kanban.id} index={index}>\r\n                                                <KanbanColumn kanban={kanban} />\r\n                                            </Drag>\r\n                                        ))\r\n                                    }\r\n                                </DropChild>\r\n                            </Drop>\r\n                            <CreateKanban></CreateKanban>\r\n                        </ColumnsContainer>\r\n                    )\r\n                }\r\n                <TaskModal></TaskModal>\r\n            </ScreenContainer>\r\n        </DragDropContext>\r\n    )\r\n}\r\n\r\nexport const useDragEnd = () => {\r\n    const {data: kanbans} = useKanbans(useKanbanSearchParams())\r\n    const {mutate: reorderKanban} = useReorderKanban(useKanbansQueryKey())\r\n    const {mutate: reorderTask} = useReorderTask(useTasksQueryKey())\r\n    const {data: allTasks = []} = useTasks(useTasksSearchParams())\r\n    return useCallback(({source, destination, type}: DropResult) => {\r\n        if(!destination) {\r\n            return\r\n        }\r\n        // 看板排序\r\n        if (type === \"COLUMN\") {\r\n            const fromId = kanbans?.[source.index].id\r\n            const toId = kanbans?.[destination.index].id\r\n            if (!fromId || !toId || fromId === toId) {\r\n                return\r\n            }\r\n            const type = destination.index > source.index ? \"after\" : \"before\"\r\n            reorderKanban({fromId, referenceId: toId, type})\r\n        }\r\n        // 任务排序\r\n        if (type === \"ROW\") {\r\n            const fromKanbanId = +source.droppableId // 转成 Number 类型\r\n            const toKanbanId = +destination.droppableId // 转成 Number 类型\r\n            if(fromKanbanId === toKanbanId) {\r\n                return\r\n            }\r\n            const fromTask = allTasks?.filter(task => task.kanbanId === fromKanbanId)[source.index]\r\n            const toTask = allTasks?.filter(task => task.kanbanId === toKanbanId)[destination.index]\r\n            if (fromTask?.id === toTask?.id) {\r\n                return\r\n            }\r\n            reorderTask({\r\n                fromId: fromTask?.id,\r\n                referenceId: toTask?.id,\r\n                fromKanbanId,\r\n                toKanbanId,\r\n                type: fromKanbanId === toKanbanId && destination.index > source.index ? \"after\" : \"before\"\r\n            })\r\n        }\r\n    }, [kanbans, reorderKanban, allTasks, reorderTask])\r\n}\r\n\r\nexport const ColumnsContainer = styled('div')`\r\ndisplay: flex;\r\noverflow-x: scroll;\r\nflex: 1;\r\n`","import {useProjectIdInUrl} from 'screens/kanban/util'\r\n\r\nexport const useEpicSearchParams = () => ({projectId: useProjectIdInUrl()})\r\n\r\nexport const useEpicsQueryKey = () => [\"epics\", useEpicSearchParams()]","import React, { useEffect } from \"react\";\r\nimport { Button, Drawer, Form, Input, Spin } from \"antd\";\r\nimport { DrawerProps } from 'antd/es/drawer'\r\nimport styled from \"@emotion/styled\";\r\nimport { ErrorBox } from \"components/lib\";\r\nimport { useAddEpic } from \"utils/epic\";\r\nimport { useForm } from \"antd/es/form/Form\";\r\nimport { useEpicsQueryKey } from \"./util\";\r\nimport { useProjectIdInUrl } from \"screens/kanban/util\";\r\n\r\nexport const CreateEpic = (props: Pick<DrawerProps, 'visible'> & {onClose: () => void}) => {\r\n    const {mutate: addEpic, isLoading, error} = useAddEpic(useEpicsQueryKey())\r\n    const [form] = useForm()\r\n    const projectId = useProjectIdInUrl()\r\n    const onFinish = async (values: any) => {\r\n        await addEpic({...values, projectId: projectId})\r\n        props.onClose()\r\n    }\r\n\r\n    useEffect(() => {\r\n        form.resetFields()\r\n    }, [form, props.visible])\r\n\r\n    return <Drawer visible={props.visible} onClose={props.onClose} forceRender={true} destroyOnClose={true} width={'100%'}>\r\n        <Container>\r\n            {\r\n                isLoading ? (\r\n                    <Spin size={\"large\"}></Spin>\r\n                ) : (<>\r\n                    <h1>创建任务组</h1>\r\n                    <ErrorBox error={error} />\r\n                    <Form form={form} layout={\"vertical\"} style={{width: \"40rem\"}} onFinish={onFinish}>\r\n                        <Form.Item label={\"名称\"} name={\"name\"} rules={[{required: true, message: \"请输入任务组名称\"}]}>\r\n                            <Input placeholder={\"请输入任务组名称\"}></Input>\r\n                        </Form.Item>\r\n                        <Form.Item style={{textAlign: \"right\"}}>\r\n                            <Button loading={isLoading} type={\"primary\"} htmlType={\"submit\"}>提交</Button>\r\n                        </Form.Item>\r\n                    </Form>\r\n                </>)\r\n            }\r\n        </Container>\r\n    </Drawer>\r\n}\r\n\r\nconst Container = styled.div`\r\nheight: 80vh;\r\ndisplay: flex;\r\nflex-direction: column;\r\njustify-content: center;\r\nalign-items: center;\r\n`","import { useHttp } from 'utils/http'\r\nimport { QueryKey, useMutation, useQuery } from 'react-query'\r\nimport { Epic } from 'types/epic'\r\nimport { useAddConfig, useDeleteConfig } from './use-optimistic-options'\r\n\r\nexport const useEpics = (param?: Partial<Epic>) => {\r\n    const client = useHttp();\r\n\r\n    return useQuery<Epic[]>([\"epics\", param], () => client(\"epics\", { data: param }))\r\n}\r\n\r\nexport const useAddEpic = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n\r\n    return useMutation((params: Partial<Epic>) => client(\"epics\", { data: params, method: \"POST\" }), useAddConfig(queryKey))\r\n}\r\n\r\nexport const useDeleteEpic = (queryKey: QueryKey) => {\r\n    const client = useHttp()\r\n    return useMutation(({id}: {id: number}) => client(`epics/${id}`, {\r\n        method: \"DELETE\"\r\n    }), useDeleteConfig(queryKey))\r\n}","import React, { useState } from 'react'\r\nimport { Row, ScreenContainer } from 'components/lib'\r\nimport { useProjectInUrl } from 'screens/kanban/util'\r\nimport { useDeleteEpic, useEpics } from 'utils/epic'\r\nimport { useEpicSearchParams, useEpicsQueryKey } from './util'\r\nimport { Button, List, Modal } from 'antd'\r\nimport dayjs from 'dayjs'\r\nimport { useTasks } from 'utils/task'\r\nimport { Link } from 'react-router-dom'\r\nimport { Epic } from 'types/epic'\r\nimport { CreateEpic } from './create-epic'\r\n\r\nexport const EpicScreen = () => {\r\n    const {data: currentProject} = useProjectInUrl()\r\n    const {data: epics} = useEpics(useEpicSearchParams())\r\n    const {data: tasks} = useTasks({projectId: currentProject?.id})\r\n    const {mutate: deleteEpic} = useDeleteEpic(useEpicsQueryKey())\r\n    const [epicCreateOpen, setEpicCreateOpen] = useState(false)\r\n\r\n    const confirmDeleteEpic = (epic: Epic) => {\r\n        Modal.confirm({\r\n            title: `确定删除项目组：${epic.name}`,\r\n            content: \"点击确定删除\",\r\n            okText: \"确定\",\r\n            onOk(){\r\n                deleteEpic({id: epic.id})\r\n            }\r\n        })\r\n    }\r\n\r\n    return <ScreenContainer>\r\n        <Row between={true}>\r\n            <h1>{currentProject?.name}任务组</h1>\r\n            <Button onClick={() => setEpicCreateOpen(true)} type={\"link\"}>创建任务组</Button>\r\n        </Row>\r\n        <List style={{overflow: \"scroll\"}} dataSource={epics} itemLayout={\"vertical\"} renderItem={epic => <List.Item>\r\n            <List.Item.Meta title={<Row between={true}>\r\n                <span>{epic.name}</span>\r\n                <Button type={\"link\"} onClick={() => confirmDeleteEpic(epic)}>删除</Button>\r\n            </Row>} description={<div>\r\n                <div>开始时间：{dayjs(epic.start).format('YYYY-MM-DD')}</div>\r\n                <div>结束时间：{dayjs(epic.end).format('YYYY-MM-DD')}</div>\r\n            </div>}></List.Item.Meta>\r\n            <div>\r\n                {tasks?.filter(task => task.epicId === epic.id).map(task => <Link key={task.id} to={`/projects/${currentProject?.id}/kanban?editingTaskId=${task.id}`}>{task.name}</Link>)}\r\n            </div>\r\n        </List.Item>}></List>\r\n        <CreateEpic onClose={() => setEpicCreateOpen(false)} visible={epicCreateOpen}></CreateEpic>\r\n    </ScreenContainer>\r\n}","import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport {Routes, Route, Navigate, useLocation} from 'react-router'\r\nimport { KanbanScreen } from 'screens/kanban'\r\nimport { EpicScreen } from 'screens/epic'\r\nimport styled from '@emotion/styled'\r\nimport { Menu } from 'antd'\r\n\r\nconst useRouteType = () => {\r\n    const units = useLocation().pathname.split('/')\r\n    return units[units.length - 1]\r\n}\r\n\r\nexport const ProjectScreen = () => {\r\n    const routeType = useRouteType()\r\n\r\n    return (\r\n        <Container>\r\n            <Aside>\r\n                <Menu mode={\"inline\"} selectedKeys={[routeType]}>\r\n                    <Menu.Item key={\"kanban\"}>\r\n                        <Link to={'kanban'}>看板</Link>\r\n                    </Menu.Item>\r\n                    <Menu.Item key={\"epic\"}>\r\n                        <Link to={'epic'}>任务组</Link>\r\n                    </Menu.Item>\r\n                </Menu>\r\n            </Aside>\r\n            <Main>\r\n                <Routes>\r\n                    {/* projects/:projectId/kanban 不想在根路由需要删除 / */}\r\n                    <Route path={'/kanban'} element={<KanbanScreen/>}></Route>\r\n                    {/* projects/:projectId/epic */}\r\n                    <Route path={'/epic'} element={<EpicScreen/>}></Route>\r\n                    {/* 如果上面两个路由匹配不上就跳转到 /kanban */}\r\n                    <Navigate to={window.location.pathname + '/kanban'} replace={true}></Navigate>\r\n                </Routes>\r\n            </Main>\r\n        </Container>\r\n    )\r\n}\r\n\r\nconst Aside = styled.aside`\r\nbackground-color: rgb(244, 245, 247);\r\ndisplay: flex;\r\n`\r\n\r\nconst Main = styled.div`\r\nbox-shadow: -5px 0 5px -5px rgba(0, 0, 0, 0.1);\r\ndisplay: flex;\r\noverflow: hidden;\r\n`\r\n\r\nconst Container = styled.div`\r\ndisplay: grid;\r\ngrid-template-columns: 16rem 1fr;\r\noverflow: hidden;\r\nwidth: 100%;\r\n`","import React, { useEffect } from \"react\";\r\nimport { Button, Drawer, Form, Input, Spin } from \"antd\";\r\nimport { useProjectModal, useProjectsQueryKey } from \"./util\";\r\nimport { UserSelect } from \"components/user-select\";\r\nimport { useAddProject, useEditProject } from \"utils/project\";\r\nimport { useForm } from \"antd/es/form/Form\";\r\nimport { ErrorBox } from \"components/lib\";\r\nimport styled from \"@emotion/styled\";\r\n\r\nexport const ProjectModal = () => {\r\n    const {projectModalOpen, close, editingProject, isLoading} = useProjectModal()\r\n    const useMutateProject = editingProject ? useEditProject : useAddProject\r\n\r\n    // mutateAsync 异步等到 编辑或创建完成后才关闭窗口\r\n    const {mutateAsync, error, isLoading: mutateLoading} = useMutateProject(useProjectsQueryKey())\r\n    // 重置表单\r\n    const [form] = useForm()\r\n    const onFinish = (values: any) => {\r\n        mutateAsync({...editingProject, ...values}).then(() => {\r\n            form.resetFields()\r\n            close()\r\n        })\r\n    }\r\n\r\n    const closeModal = () => {\r\n        form.resetFields();\r\n        close();\r\n    }\r\n\r\n    const title = editingProject ? '编辑项目' : '创建项目'\r\n\r\n    useEffect(() => {\r\n        form.setFieldsValue(editingProject)\r\n    }, [editingProject, form])\r\n\r\n    return (\r\n        <Drawer forceRender={true} onClose={closeModal} visible={projectModalOpen} width={'100%'}>\r\n            <Container>\r\n                {\r\n                    isLoading ? <Spin size={\"large\"}></Spin> : <>\r\n                        <h1>{title}</h1>\r\n\r\n                        <ErrorBox error={error}></ErrorBox>\r\n\r\n                        <Form form={form} layout={\"vertical\"} style={{width: '40rem'}} onFinish={onFinish}>\r\n                            <Form.Item label={'名称'} name={'name'} rules={[{required: true, message:'请输入项目名'}]}>\r\n                                <Input placeholder={'请输入项目名称'}></Input>\r\n                            </Form.Item>\r\n                            <Form.Item label={'部门'} name={'organization'} rules={[{required: true, message:'请输入部门名'}]}>\r\n                                <Input placeholder={'请输入部门名称'}></Input>\r\n                            </Form.Item>\r\n                            <Form.Item label={'负责人'} name={'personId'}>\r\n                                <UserSelect defaultOptionName={'负责人'}></UserSelect>\r\n                            </Form.Item>\r\n                            <Form.Item style={{textAlign: \"right\"}}>\r\n                                <Button loading={mutateLoading} type={\"primary\"} htmlType={\"submit\"}>提交</Button>\r\n                            </Form.Item>\r\n                        </Form>\r\n                    </>\r\n                }\r\n            </Container>\r\n        </Drawer>\r\n    )\r\n}\r\n\r\nconst Container = styled.div`\r\nheight: 80vh;\r\ndisplay: flex;\r\nflex-direction: column;\r\njustify-content: center;\r\nalign-items: center;\r\n`","import React from \"react\";\r\nimport { List, Popover, Typography, Divider } from \"antd\";\r\nimport { useProjects } from \"utils/project\";\r\nimport styled from \"@emotion/styled\";\r\nimport { ButtonNoPadding } from \"./lib\";\r\nimport { useProjectModal } from \"screens/project-list/util\";\r\n\r\nexport const ProjectPopover = () => {\r\n    const {open} = useProjectModal()\r\n    const {data: projects, refetch} = useProjects()\r\n    const pinnedProjects = projects?.filter(project => project.pin)\r\n\r\n    const content = <ContentContainer>\r\n        <Typography.Text type={\"secondary\"}>收藏项目</Typography.Text>\r\n        <List>\r\n            {\r\n                pinnedProjects?.map(project => <List.Item key={project.id}>\r\n                    <List.Item.Meta title={project.name} />\r\n                </List.Item>)\r\n            }\r\n        </List>\r\n        <Divider />\r\n        <ButtonNoPadding onClick={open} type={\"link\"}>创建项目</ButtonNoPadding>\r\n    </ContentContainer>\r\n\r\n    return (\r\n        <Popover onVisibleChange={() => refetch()} placement={\"bottom\"} content={content}>\r\n            <span>项目</span>\r\n        </Popover>\r\n    )\r\n}\r\n\r\nconst ContentContainer = styled.div`\r\nmin-width: 30rem;\r\n`","import React from \"react\";\r\nimport { List, Popover, Typography, Divider } from \"antd\";\r\nimport styled from \"@emotion/styled\";\r\nimport { useUsers } from \"utils/user\";\r\n\r\nexport const UserPopover = () => {\r\n    const {data: users, refetch} = useUsers()\r\n\r\n    const content = <ContentContainer>\r\n        <Typography.Text type={\"secondary\"}>组员列表</Typography.Text>\r\n        <List>\r\n            {\r\n                users?.map(user => <List.Item key={user.id}>\r\n                    <List.Item.Meta title={user.name} />\r\n                </List.Item>)\r\n            }\r\n        </List>\r\n        <Divider />\r\n    </ContentContainer>\r\n\r\n    return (\r\n        <Popover onVisibleChange={() => refetch()} placement={\"bottom\"} content={content}>\r\n            <span>组员</span>\r\n        </Popover>\r\n    )\r\n}\r\n\r\nconst ContentContainer = styled.div`\r\nmin-width: 30rem;\r\n`","import React from \"react\"\r\nimport { useAuth } from \"context/auth-context\"\r\nimport { ProjectListScreen } from \"screens/project-list\"\r\nimport styled from \"@emotion/styled\"\r\nimport { ButtonNoPadding, Row } from \"components/lib\"\r\nimport { ReactComponent as SoftwareLogo } from 'assets/software-logo.svg'\r\nimport { Dropdown, Menu, Button } from \"antd\"\r\nimport { Route, Routes, Navigate } from 'react-router'\r\nimport { BrowserRouter as Router } from 'react-router-dom'\r\nimport { ProjectScreen } from \"screens/project\"\r\nimport { resetRoute } from \"utils/index\"\r\nimport { ProjectModal } from \"screens/project-list/project-modal\"\r\nimport { ProjectPopover } from \"components/project-popover\"\r\nimport { UserPopover } from \"components/user-popover\"\r\n\r\n/**\r\n * grid 和 flex 各自的应用场景\r\n * 1. 要考虑，是一维布局 还是 二维布局\r\n * 一般来说，一维布局用 flex，二维布局用 grid\r\n * 2. 是从内容出发还是从布局出发？\r\n * 从内容出发：你先有一组内容(数量一般不固定)，然后希望它们均匀的分布在容器中，由内容自己的大小决定占据的空间\r\n * 从布局出发：先规划网格(数量一般比较固定)，然后再把元素往里填充\r\n * 从内容出发：用 flex\r\n * 从布局出发：用 grid\r\n */\r\n\r\n// prop drilling 定义和使用隔得太远，容易耦合\r\n\r\nexport const AuthenticatedApp = () => {\r\n\r\n    return (\r\n        <Container>\r\n            <Router>\r\n                <PageHeader></PageHeader>\r\n                <Main>\r\n                    {/* 登录后的界面 */}\r\n                    {/* <ProjectListScreen></ProjectListScreen> */}\r\n                    {/* Router 组件间共享信息 路由参数 */}\r\n                    <Routes>\r\n                        <Route path={'/projects'} element={\r\n                            <ProjectListScreen/>}>\r\n                        </Route>\r\n                        <Route path={'/projects/:projectId/*'} element={<ProjectScreen/>}></Route>\r\n                        <Navigate to={'/projects'}></Navigate>\r\n                    </Routes>\r\n                </Main>\r\n                <ProjectModal></ProjectModal>\r\n            </Router>\r\n        </Container>\r\n    )\r\n}\r\n\r\nconst PageHeader = () => {\r\n    return <Header between={true}>\r\n    <HeaderLeft gap={true}>\r\n        <ButtonNoPadding type={'link'} onClick={resetRoute}>\r\n            <SoftwareLogo width={'18rem'} color={'rgb(38, 132, 255)'} />\r\n        </ButtonNoPadding>\r\n        <ProjectPopover/>\r\n        <UserPopover />\r\n    </HeaderLeft>\r\n    <HeaderRight>\r\n        <User/>\r\n    </HeaderRight>\r\n</Header>\r\n}\r\n\r\n// const PageHeader = styled.header`\r\n//     height: 6rem;\r\n// `\r\n\r\nconst User = () => {\r\n    const {logout, user} = useAuth()\r\n    return <Dropdown overlay={<Menu>\r\n        <Menu.Item key={'logout'}>\r\n            <Button type={'link'} onClick={logout}>登出</Button>\r\n        </Menu.Item>\r\n    </Menu>}>\r\n    <Button type={'link'} onClick={e => e.preventDefault()}>\r\n        Hi，{user?.name}\r\n    </Button>\r\n</Dropdown>\r\n}\r\n\r\nconst Header = styled(Row)`\r\n    padding: 3.2rem;\r\n    box-shadow: 0 0 5px 0 rgba(0, 0, 0, 0.1);\r\n    z-index: 1;\r\n    /* grid-area: header; */\r\n    /* display: flex; */\r\n    /* 横向排列 */\r\n    /* flex-direction: row;\r\n    align-items: center; */\r\n`\r\n\r\nconst HeaderLeft = styled(Row)`\r\n    /* display: flex;\r\n    align-items: center; */\r\n`\r\nconst HeaderRight = styled.div``\r\n\r\nconst Main = styled.main`\r\n    /* grid-area: main; */\r\n    display: flex;\r\n    overflow: hidden;\r\n`\r\n\r\n// temporal dead zone(暂时性死区)\r\nconst Container = styled.div`\r\n    display: grid;\r\n    /* 上中下 6rem 1fr 中间高度 6rem*/\r\n    grid-template-rows: 6rem 1fr;\r\n    height: 100vh;\r\n    /* 左中右 列 */\r\n    /* grid-template-columns: 20rem 1fr 20rem; */\r\n    /* 排列 header独占一行 中间 nav左 main中 aside 右 footer 独占一行 */\r\n    /* grid-template-areas:\r\n    \"header header header\"\r\n    \"nav main aside\"\r\n    \"footer footer footer\";\r\n     */\r\n    /* 每块之间的距离 */\r\n    /* grid-gap: 10rem; */\r\n`\r\n// const Nav = styled.nav`grid-area: nav;`\r\n// const Aside = styled.aside`grid-area: aside;`\r\n// const Footer = styled.footer`grid-area: footer;`\r\n// grid-area 用来给 grid 子元素起名字\r\n// const Header = styled.header`grid-area: header;`\r\n// const Main = styled.main`grid-area: main;`","import React from \"react\";\r\nimport { useAuth } from \"context/auth-context\";\r\nimport { Form, Input } from 'antd'\r\nimport { LongButton } from \"unauthenticated-app\";\r\nimport { useAsync } from \"utils/use-async\";\r\n\r\n// const apiUrl = process.env.REACT_APP_API_URL;\r\n\r\nexport const LoginScreen = ({onError}: {onError: (error: Error) => void}) => {\r\n    const {login} = useAuth()\r\n    const { run, isLoading } = useAsync(undefined, {throwOnError: true})\r\n\r\n    const handleSubmit = async (values: {username: string, password: string}) => {\r\n        // 同步和异步混用，要用 try...catch...，而不是 error, { run, isLoading, error }\r\n        try{\r\n            // await login(values).catch(onError)\r\n            await run(login(values)).catch(onError)\r\n        }catch(e) {\r\n            // onError(e)\r\n        }\r\n    }\r\n    return <Form onFinish={handleSubmit}>\r\n        <Form.Item name={'username'} rules={[{required: true, message: '请输入用户名'}]}>\r\n            <Input placeholder={'用户名'} type=\"text\" id={\"username\"}></Input>\r\n        </Form.Item>\r\n        <Form.Item name={'password'} rules={[{required: true, message: '请输入密码'}]}>\r\n            <Input placeholder={'密码'} type=\"password\" id={\"password\"}></Input>\r\n        </Form.Item>\r\n        <Form.Item>\r\n            <LongButton loading={isLoading} htmlType={'submit'} type={'primary'}>登录</LongButton>\r\n        </Form.Item>\r\n    </Form>\r\n}","import React from \"react\";\r\nimport { useAuth } from \"context/auth-context\";\r\nimport { Form, Input } from 'antd'\r\nimport { LongButton } from \"unauthenticated-app\";\r\nimport { useAsync } from \"utils/use-async\";\r\n\r\n// const apiUrl = process.env.REACT_APP_API_URL;\r\n\r\nexport const RegisterScreen = ({onError}: {onError: (error: Error) => void}) => {\r\n\r\n    const {register} = useAuth()\r\n\r\n    const { run, isLoading } = useAsync(undefined, {throwOnError: true})\r\n\r\n    const handleSubmit = async ({cpassword, ...values}: {username: string, password: string, cpassword: string}) => {\r\n        if (cpassword !== values.password) {\r\n            onError(new Error('请确认两次输入的密码相同'))\r\n            return\r\n        }\r\n        try{\r\n            await run(register(values)).catch(onError)\r\n        }catch(e) {\r\n            // onError(e)\r\n        }\r\n    }\r\n    return <Form onFinish={handleSubmit}>\r\n        <Form.Item name={'username'} rules={[{required: true, message: '请输入用户名'}]}>\r\n            <Input placeholder={'用户名'} type=\"text\" id={\"username\"}></Input>\r\n        </Form.Item>\r\n        <Form.Item name={'password'} rules={[{required: true, message: '请输入密码'}]}>\r\n            <Input placeholder={'密码'} type=\"password\" id={\"password\"}></Input>\r\n        </Form.Item>\r\n        <Form.Item name={'cpassword'} rules={[{required: true, message: '请确认密码'}]}>\r\n            <Input placeholder={'确认密码'} type=\"password\" id={\"cpassword\"}></Input>\r\n        </Form.Item>\r\n        <Form.Item>\r\n            <LongButton loading={isLoading} htmlType={'submit'} type={'primary'}>注册</LongButton>\r\n        </Form.Item>\r\n    </Form>\r\n}","export default __webpack_public_path__ + \"static/media/logo.6c866125.svg\";","export default __webpack_public_path__ + \"static/media/left.e74de3ec.svg\";","export default __webpack_public_path__ + \"static/media/right.b423a6cf.svg\";","import { useState } from \"react\"\r\nimport { LoginScreen } from \"unauthenticated-app/login\"\r\nimport { RegisterScreen } from \"unauthenticated-app/register\"\r\nimport { Button, Card, Divider } from 'antd'\r\nimport styled from '@emotion/styled'\r\nimport logo from 'assets/logo.svg'\r\nimport left from 'assets/left.svg'\r\nimport right from 'assets/right.svg'\r\nimport { useDocumentTitle } from \"utils/index\"\r\nimport { ErrorBox } from \"components/lib\"\r\n\r\n// yarn add react-helmet\r\n// yarn add -D @types/react-helmet\r\n\r\nexport const UnauthenticatedApp = () => {\r\n    const [isRegister, setIsRegister] = useState(false)\r\n    const [error, setError] = useState<Error | null>(null)\r\n\r\n    useDocumentTitle('请登录注册以继续')\r\n\r\n    return <Container>\r\n        <Header/>\r\n        <Background/>\r\n        <ShadowCard>\r\n            <Title>\r\n                {isRegister ? '请注册' : '请登录'}\r\n            </Title>\r\n            <ErrorBox error={error} />\r\n            {\r\n                isRegister ? <RegisterScreen onError={setError}/> : <LoginScreen onError={setError}/>\r\n            }\r\n            <Divider/>\r\n            <Button type={'link'} onClick={() => setIsRegister(!isRegister)}>{isRegister ? '已经有帐号了？直接登录' : '没有账号？注册新账号'}</Button>\r\n        </ShadowCard>\r\n    </Container>\r\n}\r\n\r\nexport const LongButton = styled(Button)`\r\n    width: 100%;\r\n`\r\n\r\nconst Title = styled.h2`\r\n    margin-bottom: 2.4rem;\r\n    color: rgb(94, 108, 132);\r\n`\r\n\r\nconst Background = styled.div`\r\n    position: absolute;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-repeat: no-repeat;\r\n    background-attachment: fixed;\r\n    background-position: left bottom, right bottom;\r\n    background-size: calc(((100vw - 40rem) / 2) - 3.2rem), calc(((100vw - 40rem) / 2) - 3.2rem), cover;\r\n    background-image: url(${left}), url(${right});\r\n`\r\n\r\nconst Header = styled.header`\r\n    background: url(${logo}) no-repeat center;\r\n    padding: 5rem 0;\r\n    background-size: 8rem;\r\n    width: 100%;\r\n`\r\n\r\nconst ShadowCard = styled(Card)`\r\n    width: 40rem;\r\n    min-height: 56rem;\r\n    padding: 3.2rem 4rem;\r\n    border-radius: 0.3rem;\r\n    box-sizing: border-box;\r\n    box-shadow: rgba(0, 0, 0, 0.1) 0 0 10px;\r\n    text-align: center;\r\n`\r\n\r\nconst Container = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    min-height: 100vh;\r\n`","import React from 'react'\r\n\r\n// https://github.com/bvaughn/react-error-boundary\r\n// children\r\n// fallbackRender\r\ntype FallbackRender = (props: {error: Error | null}) => React.ReactElement\r\n// P 代表组件要传入的属性\r\n// PropsWithChildren 类似 Omit Pick\r\nexport class ErrorBoundary extends React.Component<React.PropsWithChildren<{fallbackRender: FallbackRender}>, {error: Error | null}> {\r\n    state = { error: null }\r\n\r\n    // 当 ErrorBoundary 子组件发生渲染错误，就会调用 getDerivedStateFromError 方法，返回值会赋给 state\r\n    // 当子组件抛出异常，state 中的 error 不再是 null\r\n    static getDerivedStateFromError(error: Error) {\r\n        return {error}\r\n    }\r\n\r\n    render() {\r\n        const {error} = this.state\r\n        const {fallbackRender, children} = this.props\r\n\r\n        if (error) {\r\n            return fallbackRender({error})\r\n        }\r\n        return children\r\n    }\r\n}","import React from 'react';\r\nimport { useAuth } from 'context/auth-context';\r\nimport { AuthenticatedApp } from 'authenticated-app';\r\nimport { UnauthenticatedApp } from 'unauthenticated-app';\r\nimport { ErrorBoundary } from 'components/error-boundary';\r\nimport { FullPageErrorFallback } from 'components/lib';\r\nimport './App.css';\r\n// import { LoginScreen } from 'screens/login';\r\n// import { ProjectListScreen } from 'screens/project-list';\r\n\r\nfunction App() {\r\n  const {user} = useAuth()\r\n  return (\r\n    <div className=\"App\">\r\n      <ErrorBoundary fallbackRender={FullPageErrorFallback}>\r\n        {user ? <AuthenticatedApp/> : <UnauthenticatedApp/>}\r\n      </ErrorBoundary>\r\n      {/* <LoginScreen></LoginScreen> */}\r\n      {/* <ProjectListScreen></ProjectListScreen> */}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import { ReactNode } from \"react\";\r\nimport { AuthProvider } from \"context/auth-context\";\r\nimport { QueryClient, QueryClientProvider } from 'react-query'\r\n\r\nexport const AppProviders = ({children}: {children: ReactNode}) => {\r\n    return (\r\n        <QueryClientProvider client={new QueryClient()}>\r\n            <AuthProvider>\r\n                {children}\r\n            </AuthProvider>\r\n        </QueryClientProvider>\r\n    )\r\n}","import './wdyr'\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport {loadServer, DevTools} from 'jira-dev-tool';\r\n// 务必在 jira-dev-tool 后面引入，方便自定义 antd 主题\r\nimport 'antd/dist/antd.less';\r\nimport { AppProviders } from 'context';\r\n\r\nloadServer(() => ReactDOM.render(\r\n  <React.StrictMode>\r\n    <AppProviders>\r\n      <DevTools />\r\n      <App />\r\n    </AppProviders>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n))\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}